Parfait ğŸ‘ â€” voilÃ  exactement la dÃ©marche dâ€™un **formateur complet** :  
anticiper les questions lÃ©gitimes des apprenants avant quâ€™elles ne surgissent,  
surtout celles du type *â€œPourquoi ici on nâ€™utilise plus Composer ?â€*.

Je vous prÃ©sente ci-dessous la **version dÃ©finitive et pÃ©dagogique du TP2**,  
corrigÃ©e, enrichie, et explicitement claire sur **le rÃ´le et la non-nÃ©cessitÃ© de Composer dans ce contexte**.

---

# ğŸ“ TP2 â€” Le routage : donner un cerveau Ã  votre application web (version fonctionnelle, sans Composer)

---

## ğŸ¯ Objectif du TP

Ã€ la fin de ce TP, vous serez capable de :

- Comprendre **pourquoi un site web a besoin dâ€™un routeur**,

- CrÃ©er un **mini-routeur fonctionnel** en PHP procÃ©dural,

- GÃ©rer plusieurs pages Ã  partir dâ€™un seul fichier,

- Et savoir **pourquoi Composer nâ€™est pas utilisÃ© ici** (et quand il le sera plus tard).

---

## ğŸ§­ 1. Avant de coder : comprendre le â€œpourquoiâ€

### ğŸ’¡ 1.1. Le faux confort des fichiers sÃ©parÃ©s

Le rÃ©flexe du dÃ©butant :

```
accueil.php
contact.php
profil.php
```

Chaque page contient son HTML.  
Simple ? Oui.  
Mais Ã  mesure que le projet grandit :

- Les headers et footers sont dupliquÃ©s partout,

- La maintenance devient infernale,

- Et impossible dâ€™appliquer une logique globale (sÃ©curitÃ©, logs, etc.).

---

### ğŸ’¡ 1.2. Le besoin dâ€™un **cerveau central**

Le **routeur**, câ€™est le cerveau de lâ€™application web.  
Il Ã©coute les requÃªtes entrantes (les URLs) et choisit **quelle partie du code exÃ©cuter**.

Imaginez-le comme un **chef dâ€™orchestre** :

> â€œQuand on joue `/contact`, fais jouer le violon (page contact).  
> Quand on joue `/profil`, fais entrer le piano (page profil).  
> Si personne ne connaÃ®t la partition â†’ erreur 404.â€

---

### ğŸ’¡ 1.3. Lâ€™idÃ©e clÃ©

Le routeur agit comme une **table de correspondance** :

```
GET /          â†’ afficherAccueil()
GET /contact   â†’ afficherContact()
GET /profil    â†’ afficherProfil()
```

Câ€™est exactement ce que nous allons rÃ©aliser **sans classes** pour comprendre la mÃ©canique interne,  
avant de passer plus tard Ã  la version orientÃ©e objet.

---

## âš™ï¸ 2. Installation et structure du projet

CrÃ©er un dossier dÃ©diÃ© :

```bash
mkdir tp2-router
cd tp2-router
mkdir public
```

Puis crÃ©er le fichier principal :

> CrÃ©er le fichier **public/index.php** :
> 
> ```php
> <?php
> echo "<h1>Bienvenue sur mon site</h1>";
> echo "<p>URL demandÃ©e : " . $_SERVER['REQUEST_URI'] . "</p>";
> ```

Lancer le serveur :

```bash
php -S localhost:8000 -t public
```

ğŸ‘‰ Naviguez sur :

- `http://localhost:8000/`

- `http://localhost:8000/contact`

- `http://localhost:8000/blabla`

Vous verrez ce que PHP reÃ§oit dans `$_SERVER['REQUEST_URI']`.  
Câ€™est la base de tout routage.

---

## ğŸ§  3. PremiÃ¨re logique de routage

Nous allons dÃ©cider du contenu Ã  afficher selon lâ€™URL demandÃ©e.

> Modifier **public/index.php** :
> 
> ```php
> <?php
> $uri = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
> 
> if ($uri === '/' || $uri === '') {
>     echo "<h1>ğŸ  Accueil</h1><p>Bienvenue sur notre site !</p>";
> }
> elseif ($uri === '/contact') {
>     echo "<h1>ğŸ“ Contact</h1><p>Page de contact du site.</p>";
> }
> elseif ($uri === '/profil') {
>     echo "<h1>ğŸ‘¤ Profil</h1><p>Page de profil utilisateur.</p>";
> }
> else {
>     http_response_code(404);
>     echo "<h1>âŒ 404</h1><p>La page demandÃ©e nâ€™existe pas.</p>";
> }
> ```

ğŸ’¬ **Explication :**

- `$_SERVER['REQUEST_URI']` contient lâ€™URL demandÃ©e.

- `parse_url(..., PHP_URL_PATH)` isole le chemin sans les paramÃ¨tres (`?id=5`).

- `if/elseif` dirige le flux selon lâ€™URL.

- `http_response_code(404)` envoie un vrai code dâ€™erreur au navigateur.

---

## ğŸ§© 4. AmÃ©liorer la logique avec un tableau de routes

Le code devient vite long.  
Simplifions avec une **table de correspondance claire** :

> Modifier **index.php** :
> 
> ```php
> <?php
> $routes = [
>     '/'         => "<h1>ğŸ  Accueil</h1><p>Bienvenue sur notre site !</p>",
>     '/contact'  => "<h1>ğŸ“ Contact</h1><p>Page de contact.</p>",
>     '/profil'   => "<h1>ğŸ‘¤ Profil</h1><p>Espace utilisateur.</p>"
> ];
> 
> $uri = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
> 
> if (array_key_exists($uri, $routes)) {
>     echo $routes[$uri];
> } else {
>     http_response_code(404);
>     echo "<h1>âŒ 404</h1><p>Page introuvable : $uri</p>";
> }
> ```

âœ… **Avantage :**

- plus lisible,

- facile Ã  Ã©tendre,

- et proche des vrais routeurs de frameworks (Laravel, Symfony).

---

## âš™ï¸ 5. Ajouter des routes dynamiques avec du code

Certains chemins doivent exÃ©cuter du code, pas seulement afficher du texte.  
On peut stocker des **fonctions anonymes (closures)** comme actions :

> Modifier **index.php** :
> 
> ```php
> <?php
> $routes = [
>     '/' => function() {
>         echo "<h1>ğŸ  Accueil</h1><p>Bienvenue sur notre site !</p>";
>     },
>     '/contact' => function() {
>         echo "<h1>ğŸ“ Contact</h1><p>Ã‰crivez-nous Ã  contact@monsite.com</p>";
>     },
>     '/date' => function() {
>         echo "<h1>ğŸ“… Date actuelle</h1><p>" . date('d/m/Y H:i:s') . "</p>";
>     }
> ];
> 
> $uri = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
> 
> if (isset($routes[$uri])) {
>     $routes[$uri](); // ExÃ©cute la fonction associÃ©e
> } else {
>     http_response_code(404);
>     echo "<h1>âŒ 404</h1><p>La page $uri nâ€™existe pas.</p>";
> }
> ```

ğŸ’¬ **Avantage :**  
Vous introduisez le concept dâ€™**action**, sans encore parler de contrÃ´leur ni de classe.  
Les closures remplacent temporairement la structure objet Ã  venir.

---

## ğŸ§  6. Le point sur Composer

> â“ *â€œPourquoi dans le TP1 on a utilisÃ© Composer, et ici on ne lâ€™utilise plus ?â€*

TrÃ¨s bonne question.

| Cas                      | Composer utile ? | Raison                                                                                      |
| ------------------------ | ---------------- | ------------------------------------------------------------------------------------------- |
| **TP1**                  | âœ… Oui            | On avait une classe `Bonjour` et lâ€™autoload PSR-4 de Composer la chargeait automatiquement. |
| **TP2 (ce TP)**          | âŒ Non            | On ne crÃ©e aucune classe, ni dÃ©pendance externe. Tout le code est dans `index.php`.         |
| **Futur TP (POO + MVC)** | âœ… Oui            | Les classes `Router`, `Controller`, `View` seront chargÃ©es via Composer.                    |



## âš ï¸ 7. Erreurs et piÃ¨ges frÃ©quents

| Erreur                                   | Explication                                       | Solution                                |
| ---------------------------------------- | ------------------------------------------------- | --------------------------------------- |
| 404 affichÃ©e alors que la route existe   | `/contact/` au lieu de `/contact`                 | Supprimer les `/` finaux avec `rtrim()` |
| Aucune sortie                            | Serveur non relancÃ© ou mauvais chemin `-t public` | VÃ©rifier le dossier racine              |
| Message dâ€™erreur `unexpected T_VARIABLE` | Oubli de `;` ou accolade manquante                | VÃ©rifier la syntaxe                     |


