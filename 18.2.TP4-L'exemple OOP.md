

# üéì TP6 ‚Äî Construire une mini-application orient√©e objet compl√®te

### (Avec h√©ritage, encapsulation, interfaces, polymorphisme‚Ä¶ et Composer)

---

## üéØ Objectifs p√©dagogiques

Ce TP vise √† **mettre en pratique tous les concepts de la POO** d√©j√† vus dans *12. La OOP*,  
en construisant une mini-application web simul√©e.

Le tout sera organis√©, charg√© via **Composer**, et respectera :

- l‚Äôencapsulation (propri√©t√©s prot√©g√©es, getters/setters),

- l‚Äôh√©ritage (classe de base + classes enfants),

- le polymorphisme (m√™mes interfaces, comportements diff√©rents),

- les classes abstraites et interfaces,

- les m√©thodes statiques et non statiques,

- et l‚Äôautoload PSR-4 g√©r√© par **Composer**.

---

## üß≠ 1. Contexte du TP

Nous allons cr√©er une **application de gestion simplifi√©e d‚Äôutilisateurs** :

> Chaque utilisateur a un profil (Admin, Membre, Visiteur).  
> Chaque type d‚Äôutilisateur a un comportement diff√©rent pour ‚Äúafficher son tableau de bord‚Äù.

On y int√©grera :

- une **classe abstraite `Utilisateur`**,

- des **classes enfants** : `Admin`, `Membre`, `Visiteur`,

- une **interface `Authentifiable`**,

- une **classe `SessionManager`** avec m√©thode statique,

- une **classe `App`** centralisant la logique.

---

## ‚öôÔ∏è 2. Structure du projet

```
tp6-app/
‚îú‚îÄ‚îÄ composer.json
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Authentifiable.php
‚îÇ   ‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Utilisateur.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Admin.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Membre.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Visiteur.php
‚îÇ   ‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SessionManager.php
‚îÇ   ‚îî‚îÄ‚îÄ App.php
‚îî‚îÄ‚îÄ public/
    ‚îî‚îÄ‚îÄ index.php
```

---

## ‚öôÔ∏è 3. Initialiser Composer et l‚Äôautoload PSR-4

```bash
cd tp6-app
composer init -n
```

Modifier le fichier **composer.json** :

```json
{
  "autoload": {
    "psr-4": {
      "App\\": "src/"
    }
  }
}
```

G√©n√©rer l‚Äôautoload :

```bash
composer dump-autoload
```

---

## üß© 4. D√©finir l‚Äôinterface `Authentifiable`

> Cr√©er le fichier **src/Interfaces/Authentifiable.php** :
> 
> ```php
> <?php
> namespace App\Interfaces;
> 
> interface Authentifiable {
>     public function seConnecter(): string;
>     public function seDeconnecter(): string;
> }
> ```

Cette interface garantit que toutes les classes utilisateurs  
auront les m√™mes m√©thodes de connexion/d√©connexion.

---

## üß© 5. Cr√©er la classe abstraite `Utilisateur`

> Cr√©er le fichier **src/Core/Utilisateur.php** :
> 
> ```php
> <?php
> namespace App\Core;
> use App\Interfaces\Auth
> ```

> entifiable;
> 
> abstract class Utilisateur implements Authentifiable {  
> protected string $nom;  
> protected string $role;
> 
> ```
> public function __construct(string $nom, string $role) {
>     $this->nom  = $nom;
>     $this->role = $role;
> }
> 
> public function getNom(): string {
>     return $this->nom;
> }
> 
> public function getRole(): string {
>     return $this->role;
> }
> 
> // M√©thode abstraite commune √† tous
> abstract public function afficherDashboard(): string;
> 
> public function seConnecter(): string {
>     return "{$this->nom} est connect√© en tant que {$this->role}.";
> }
> 
> public function seDeconnecter(): string {
>     return "{$this->nom} s‚Äôest d√©connect√©.";
> }
> ```
> 
> }

üí¨ **Points p√©dagogiques :**

- Abstraction ‚Üí `afficherDashboard()` obligatoire dans les classes enfants.

- Encapsulation ‚Üí propri√©t√©s prot√©g√©es, accessibles via getters.

- Interface ‚Üí `Authentifiable` impose `seConnecter()` et `seDeconnecter()`.

---

## üß© 6. Cr√©er les classes enfants

### Admin

> Cr√©er **src/Core/Admin.php** :
> 
> ```php
> <?php
> namespace App\Core;
> 
> class Admin extends Utilisateur {
>     public function afficherDashboard(): string {
>         return "üëë Tableau de bord administrateur : gestion des utilisateurs et des logs.";
>     }
> }
> ```

### Membre

> Cr√©er **src/Core/Membre.php** :
> 
> ```php
> <?php
> namespace App\Core;
> 
> class Membre extends Utilisateur {
>     public function afficherDashboard(): string {
>         return "üßë‚Äçüíª Espace membre : vos projets, vos favoris et votre messagerie.";
>     }
> }
> ```

### Visiteur

> Cr√©er **src/Core/Visiteur.php** :
> 
> ```php
> <?php
> namespace App\Core;
> 
> class Visiteur extends Utilisateur {
>     public function afficherDashboard(): string {
>         return "üëÄ Bienvenue visiteur : connectez-vous pour acc√©der √† votre espace personnel.";
>     }
> }
> ```

---

## üß© 7. G√©rer les sessions avec une m√©thode statique

> Cr√©er **src/Services/SessionManager.php** :
> 
> ```php
> <?php
> namespace App\Services;
> 
> class SessionManager {
>     public static function demarrer(): void {
>         if (session_status() === PHP_SESSION_NONE) {
>             session_start();
>         }
>     }
> 
>     public static function set(string $key, mixed $value): void {
>         $_SESSION[$key] = $value;
>     }
> 
>     public static function get(string $key): mixed {
>         return $_SESSION[$key] ?? null;
>     }
> 
>     public static function detruire(): void {
>         session_destroy();
>     }
> }
> ```

üí¨ **Explication :**

- M√©thodes statiques : pas besoin d‚Äôinstancier `SessionManager`.

- Illustrent un usage typique du statique dans les services utilitaires.

---

## üß© 8. Classe `App` ‚Äì orchestrer le tout

> Cr√©er **src/App.php** :
> 
> ```php
> <?php
> namespace App;
> 
> use App\Core\Admin;
> use App\Core\Membre;
> use App\Core\Visiteur;
> use App\Services\SessionManager;
> 
> class App {
>     public function run(): void {
>         SessionManager::demarrer();
> 
>         // Simulation : r√©cup√©rer un r√¥le stock√© en session
>         $role = $_GET['role'] ?? 'visiteur';
>         $nom  = $_GET['nom']  ?? 'Invit√©';
> 
>         switch (strtolower($role)) {
>             case 'admin':
>                 $user = new Admin($nom, 'Administrateur');
>                 break;
>             case 'membre':
>                 $user = new Membre($nom, 'Membre');
>                 break;
>             default:
>                 $user = new Visiteur($nom, 'Visiteur');
>                 break;
>         }
> 
>         echo "<h2>" . $user->seConnecter() . "</h2>";
>         echo "<p>"  . $user->afficherDashboard() . "</p>";
>         echo "<p>"  . $user->seDeconnecter() . "</p>";
>     }
> }
> ```

---

## üß© 9. Fichier d‚Äôentr√©e public

> Cr√©er **public/index.php** :
> 
> ```php
> <?php
> require __DIR__ . '/../vendor/autoload.php';
> 
> use App\App;
> 
> $application = new App();
> $application->run();
> ```

---

## üß™ 10. Test pratique

Lancer le serveur :

```bash
php -S localhost:8000 -t public
```

### Sc√©narios :

| URL                       | R√©sultat attendu                 |
| ------------------------- | -------------------------------- |
| `/`                       | Dashboard du visiteur            |
| `/?role=membre&nom=Ali`   | Espace membre personnalis√©       |
| `/?role=admin&nom=Bechir` | Dashboard administrateur complet |

---

## üß† 11. Concepts mobilis√©s dans ce TP

| Concept            | O√π il appara√Æt                | R√¥le concret                                                 |
| ------------------ | ----------------------------- | ------------------------------------------------------------ |
| Encapsulation      | `Utilisateur`                 | Prot√®ge les propri√©t√©s `nom`, `role`                         |
| H√©ritage           | `Admin`, `Membre`, `Visiteur` | Partagent la structure de `Utilisateur`                      |
| Abstraction        | `Utilisateur`                 | Emp√™che l‚Äôinstanciation directe, force `afficherDashboard()` |
| Interface          | `Authentifiable`              | Contrat commun de connexion                                  |
| Polymorphisme      | `App::run()`                  | G√®re les utilisateurs de diff√©rents types de fa√ßon uniforme  |
| M√©thodes statiques | `SessionManager`              | Acc√®s global au service de session                           |
| Composer / PSR-4   | Chargement automatique        | Supprime les `require` manuels                               |

---

## üß© 12. R√©sum√© p√©dagogique

> Le TP6 n‚Äôest pas une d√©monstration de syntaxe,  
> c‚Äôest une **orchestration concr√®te des paradigmes de la POO** dans une application compl√®te.

Ce TP **rassemble tous les piliers** dans une ≈ìuvre coh√©rente :

- un *moule abstrait*,

- des *variantes concr√®tes*,

- un *contrat d‚Äôinterop√©rabilit√©*,

- un *service statique*,

- et un *chargeur automatique*.

C‚Äôest une d√©monstration de **maturit√© PHP** et de **pens√©e objet ma√Ætris√©e**.


