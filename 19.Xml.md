Voici une version profondÃ©ment amÃ©liorÃ©e avec une approche pÃ©dagogique concrÃ¨te et un mini-projet rÃ©ellement utile :

---

# Atelier PHP â€“ DÃ©veloppement Web : La Pratique qui Donne du Sens !

## ğŸ¯ Objectif PÃ©dagogique

**Passer de "je copie du code" Ã  "je comprends les mÃ©canismes web rÃ©els"**

---

## ğŸ§  Le Paradigme Mental : Le Restaurant Web

**Imaginez que votre site web est un restaurant :**

- **Client (navigateur)** â†’ Le client qui commande
- **Serveur (PHP)** â†’ Le chef en cuisine  
- **HTML** â†’ Le plat servi
- **GET/POST** â†’ La faÃ§on de commander
- **Sessions** â†’ La table attribuÃ©e au client
- **Cookies** â†’ La carte de fidÃ©litÃ©

---

## ğŸ¢ 1. Introduction Ã  la GÃ©nÃ©ration Dynamique : Le Chef en Cuisine

**ScÃ©nario :** Page d'accueil personnalisÃ©e

```php
<?php
// ğŸ¯ ANALOGIE : Le chef prÃ©pare le plat AVANT de le servir
$utilisateur = "Marie";
$moment = date("H") < 12 ? "matin" : "aprÃ¨s-midi";
$date_serveur = date("d/m/Y Ã  H:i");
?>
<!DOCTYPE html>
<html>
<head>
    <title>Restaurant Web - Accueil</title>
    <style>
        .personnalise { color: #2c3e50; background: #ecf0f1; padding: 20px; border-radius: 10px; }
    </style>
</head>
<body>
    <div class="personnalise">
        <h1>ğŸ½ï¸ Bonjour <?= $utilisateur ?> !</h1>
        <p>Bienvenue sur notre site, nous sommes le <strong><?= $date_serveur ?></strong></p>
        <p>Excellent <?= $moment ?> Ã  vous !</p>
    </div>

    <!-- ğŸ§  QUESTION PÃ‰DAGOGIQUE : -->
    <!-- Que se passe-t-il si vous actualisez la page ? -->
    <!-- RÃ©ponse : Le serveur REGÃ‰NÃˆRE le HTML avec l'heure actuelle -->
</body>
</html>
```

**ğŸ’¡ Le POURQUOI :** PHP s'exÃ©cute cÃ´tÃ© serveur â†’ HTML personnalisÃ© gÃ©nÃ©rÃ© Ã  CHAQUE requÃªte.

---

## ğŸ” 2. Identification du Client : La Carte d'IdentitÃ© du Visiteur

**ScÃ©nario :** Analytics basique pour comprendre votre audience

```php
<?php
// ğŸ¯ ANALOGIE : Le restaurant identifie ses clients
$ip_client = $_SERVER['REMOTE_ADDR'];
$navigateur = $_SERVER['HTTP_USER_AGENT'];
$page_demandee = $_SERVER['REQUEST_URI'];
$heure_visite = date('H:i:s');

// DÃ©tection simplifiÃ©e du navigateur
if (strpos($navigateur, 'Chrome') !== false) {
    $navigateur_detecte = "Chrome ğŸš€";
} elseif (strpos($navigateur, 'Firefox') !== false) {
    $navigateur_detecte = "Firefox ğŸ¦Š";
} else {
    $navigateur_detecte = "Autre ğŸŒ";
}
?>
<!DOCTYPE html>
<html>
<body>
    <h2>ğŸ“Š Analytics de Votre Visiteur</h2>
    <div style="background:#f8f9fa; padding:15px; border-left:4px solid #3498db;">
        <p><strong>ğŸ“ IP:</strong> <?= $ip_client ?></p>
        <p><strong>ğŸ•’ Heure:</strong> <?= $heure_visite ?></p>
        <p><strong>ğŸŒ Navigateur:</strong> <?= $navigateur_detecte ?></p>
        <p><strong>ğŸ“„ Page:</strong> <?= $page_demandee ?></p>
    </div>

    <!-- ğŸ¯ UTILISATION RÃ‰ELLE : -->
    <!-- Ces infos permettent de personnaliser l'expÃ©rience utilisateur -->
</body>
</html>
```

---

## ğŸ“¤ 3. MÃ©thode GET : La Commande par URL

**ScÃ©nario :** Recherche de produits avec paramÃ¨tres URL

```html
<!-- search_form.html -->
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ” Recherche de Produits</h3>
    <form action="search_results.php" method="get">
        <input type="text" name="produit" placeholder="Que cherchez-vous ?" required>
        <select name="categorie">
            <option value="">Toutes catÃ©gories</option>
            <option value="electronique">Ã‰lectronique</option>
            <option value="livres">Livres</option>
            <option value="vetements">VÃªtements</option>
        </select>
        <button type="submit">Rechercher ğŸ”</button>
    </form>

    <!-- ğŸ’¡ OBSERVEZ L'URL APRÃˆS SOUMISSION : -->
    <!-- search_results.php?produit=iphone&categorie=electronique -->
</body>
</html>
```

```php
<?php
// search_results.php
// ğŸ¯ ANALOGIE : Le client commande via l'URL (comme un menu)
$produit = htmlspecialchars($_GET['produit'] ?? '');
$categorie = htmlspecialchars($_GET['categorie'] ?? 'toutes');

echo "<h3>RÃ©sultats pour : \"$produit\"</h3>";
echo "<p>Dans la catÃ©gorie : $categorie</p>";

// ğŸ§  POURQUOI GET ? :
// - Partageable (lien spÃ©cifique)
// - Historique navigateur
// - LimitÃ© en taille
?>
```

---

## ğŸ“¥ 4. MÃ©thode POST : La Commande DiscrÃ¨te

**ScÃ©nario :** Formulaire de contact sÃ©curisÃ©

```php
<?php
// contact.php
// ğŸ¯ ANALOGIE : Commande discrÃ¨te (donnÃ©es sensibles)
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // ğŸ›¡ï¸ VALIDATION ET SÃ‰CURISATION
    $nom = htmlspecialchars(trim($_POST['nom']));
    $email = filter_var(trim($_POST['email']), FILTER_VALIDATE_EMAIL);
    $message = htmlspecialchars(trim($_POST['message']));

    if ($email && !empty($nom) && !empty($message)) {
        echo "<div style='color:green; padding:10px; background:#d4edda;'>âœ… Message envoyÃ© avec succÃ¨s !</div>";
        echo "<p>Merci <strong>$nom</strong>, nous vous rÃ©pondrons Ã  <strong>$email</strong></p>";

        // ğŸ¯ UTILISATION RÃ‰ELLE : Envoi email ici
    } else {
        echo "<div style='color:red; padding:10px; background:#f8d7da;'>âŒ Veuillez corriger les erreurs</div>";
    }
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ“§ Contactez-nous</h3>
    <form method="post">
        <p><input type="text" name="nom" placeholder="Votre nom" required value="<?= $nom ?? '' ?>"></p>
        <p><input type="email" name="email" placeholder="Votre email" required value="<?= $email ?? '' ?>"></p>
        <p><textarea name="message" placeholder="Votre message" required rows="4"><?= $message ?? '' ?></textarea></p>
        <button type="submit">Envoyer le message âœ‰ï¸</button>
    </form>
</body>
</html>
```

**ğŸ§  POURQUOI POST ? :**

- DonnÃ©es sensibles (mots de passe, messages)
- Pas de limitation taille
- Invisible dans l'URL

---

## ğŸ›¡ï¸ 5. Validation AvancÃ©e : Le ContrÃ´le QualitÃ©

**ScÃ©nario :** Inscription utilisateur avec validation complÃ¨te

```php
<?php
// validation_avancee.php
$erreurs = [];

if ($_POST) {
    // ğŸ¯ VALIDATION CHAMP PAR CHAMP
    $email = trim($_POST['email'] ?? '');
    $age = $_POST['age'] ?? '';
    $newsletter = isset($_POST['newsletter']);

    // Validation Email
    if (empty($email)) {
        $erreurs['email'] = "L'email est obligatoire";
    } elseif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
        $erreurs['email'] = "Format d'email invalide";
    }

    // Validation Ã‚ge
    if (empty($age)) {
        $erreurs['age'] = "L'Ã¢ge est obligatoire";
    } elseif (!is_numeric($age) || $age < 18 || $age > 120) {
        $erreurs['age'] = "L'Ã¢ge doit Ãªtre entre 18 et 120 ans";
    }

    // Si pas d'erreurs
    if (empty($erreurs)) {
        echo "<div style='color:green;'>ğŸ‰ Inscription rÃ©ussie !</div>";
        // ğŸ¯ UTILISATION RÃ‰ELLE : Sauvegarde en base de donnÃ©es
    }
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ‘¤ CrÃ©ation de Compte</h3>
    <form method="post">
        <p>
            <input type="email" name="email" placeholder="Votre email" value="<?= htmlspecialchars($_POST['email'] ?? '') ?>">
            <?php if (isset($erreurs['email'])): ?>
                <small style="color:red;"><?= $erreurs['email'] ?></small>
            <?php endif; ?>
        </p>

        <p>
            <input type="number" name="age" placeholder="Votre Ã¢ge" value="<?= htmlspecialchars($_POST['age'] ?? '') ?>">
            <?php if (isset($erreurs['age'])): ?>
                <small style="color:red;"><?= $erreurs['age'] ?></small>
            <?php endif; ?>
        </p>

        <p>
            <label>
                <input type="checkbox" name="newsletter" <?= isset($_POST['newsletter']) ? 'checked' : '' ?>>
                S'abonner Ã  la newsletter
            </label>
        </p>

        <button type="submit">S'inscrire ğŸš€</button>
    </form>
</body>
</html>
```

---

## ğŸ“ 6. Upload de Fichiers : Le Service de Stockage

**ScÃ©nario :** Portfolio personnel - upload d'images

```php
<?php
// upload_portfolio.php
$message = '';

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['portfolio_image'])) {
    $fichier = $_FILES['portfolio_image'];

    // ğŸ¯ VALIDATION DU FICHIER
    $extensions_autorisees = ['jpg', 'jpeg', 'png', 'gif'];
    $extension = strtolower(pathinfo($fichier['name'], PATHINFO_EXTENSION));

    // VÃ©rification type fichier
    if (!in_array($extension, $extensions_autorisees)) {
        $message = "âŒ Seuls les JPG, PNG et GIF sont autorisÃ©s";
    }
    // VÃ©rification taille (2MB max)
    elseif ($fichier['size'] > 2 * 1024 * 1024) {
        $message = "âŒ Le fichier est trop volumineux (2MB max)";
    }
    // VÃ©rification erreur upload
    elseif ($fichier['error'] !== UPLOAD_ERR_OK) {
        $message = "âŒ Erreur lors de l'upload";
    }
    // âœ… TOUT EST BON
    else {
        $nouveau_nom = uniqid() . '.' . $extension;
        $destination = 'uploads/' . $nouveau_nom;

        if (move_uploaded_file($fichier['tmp_name'], $destination)) {
            $message = "âœ… Image ajoutÃ©e Ã  votre portfolio !";
        } else {
            $message = "âŒ Erreur de sauvegarde";
        }
    }
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ–¼ï¸ Ajouter Ã  Votre Portfolio</h3>

    <?php if ($message): ?>
        <div style="padding:10px; margin:10px 0; background:<?= strpos($message, 'âœ…') !== false ? '#d4edda' : '#f8d7da' ?>">
            <?= $message ?>
        </div>
    <?php endif; ?>

    <form method="post" enctype="multipart/form-data">
        <p>
            <label><strong>SÃ©lectionnez une image :</strong></label><br>
            <input type="file" name="portfolio_image" accept=".jpg,.jpeg,.png,.gif" required>
        </p>
        <small>Formats: JPG, PNG, GIF | Taille max: 2MB</small>
        <p><button type="submit">Uploader l'image ğŸ“¤</button></p>
    </form>
</body>
</html>
```

---

## ğŸª 7. Cookies : La MÃ©moire Ã  Long Terme

**ScÃ©nario :** Personnalisation du thÃ¨me utilisateur

```php
<?php
// cookies_theme.php

// ğŸ¯ GESTION DU THÃˆME
$theme_actuel = $_COOKIE['theme_prefere'] ?? 'clair';

if (isset($_POST['changer_theme'])) {
    $nouveau_theme = $_POST['theme'];
    setcookie('theme_prefere', $nouveau_theme, time() + (30 * 24 * 3600)); // 30 jours
    $theme_actuel = $nouveau_theme;

    // Recharger pour appliquer le thÃ¨me
    header("Location: " . $_SERVER['PHP_SELF']);
    exit;
}

// Application du thÃ¨me
$style_css = $theme_actuel === 'sombre' 
    ? 'background: #2c3e50; color: #ecf0f1;' 
    : 'background: #ecf0f1; color: #2c3e50;';
?>
<!DOCTYPE html>
<html>
<body style="<?= $style_css ?>; padding:20px; min-height:200px;">
    <h3>ğŸ¨ Personnalisation du ThÃ¨me</h3>

    <p><strong>ThÃ¨me actuel :</strong> <?= $theme_actuel === 'sombre' ? 'ğŸŒ™ Sombre' : 'â˜€ï¸ Clair' ?></p>

    <form method="post">
        <select name="theme">
            <option value="clair" <?= $theme_actuel === 'clair' ? 'selected' : '' ?>>ThÃ¨me Clair</option>
            <option value="sombre" <?= $theme_actuel === 'sombre' ? 'selected' : '' ?>>ThÃ¨me Sombre</option>
        </select>
        <button type="submit" name="changer_theme">Appliquer ğŸ¯</button>
    </form>

    <div style="margin-top:20px; padding:15px; border:1px solid #ccc;">
        <h4>ğŸ’¡ Comprendre les Cookies :</h4>
        <p>Les cookies sont stockÃ©s dans votre navigateur et rappelÃ©s Ã  chaque visite.</p>
        <p><strong>Fermez et rouvrez cette page pour voir la persistance !</strong></p>
    </div>
</body>
</html>
```

---

## ğŸ’¾ 8. Sessions : La MÃ©moire de la Visite

**ScÃ©nario :** Panier d'achat e-commerce

```php
<?php
// session_panier.php
session_start();

// ğŸ¯ INITIALISATION DU PANIER
if (!isset($_SESSION['panier'])) {
    $_SESSION['panier'] = [];
}

// ğŸ¯ AJOUT AU PANIER
if (isset($_POST['ajouter_produit'])) {
    $produit = [
        'id' => uniqid(),
        'nom' => $_POST['nom_produit'],
        'prix' => floatval($_POST['prix_produit']),
        'quantite' => 1,
        'date_ajout' => date('H:i:s')
    ];

    $_SESSION['panier'][] = $produit;
}

// ğŸ¯ VIDER LE PANIER
if (isset($_POST['vider_panier'])) {
    $_SESSION['panier'] = [];
}

// ğŸ¯ CALCUL DU TOTAL
$total = 0;
foreach ($_SESSION['panier'] as $item) {
    $total += $item['prix'];
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ›’ Votre Panier d'Achat</h3>

    <!-- FORMULAIRE AJOUT PRODUIT -->
    <form method="post" style="background:#f8f9fa; padding:15px; margin-bottom:20px;">
        <h4>â• Ajouter un produit</h4>
        <input type="text" name="nom_produit" placeholder="Nom du produit" required>
        <input type="number" step="0.01" name="prix_produit" placeholder="Prix (â‚¬)" required>
        <button type="submit" name="ajouter_produit">Ajouter au panier</button>
    </form>

    <!-- AFFICHAGE PANIER -->
    <div style="background:#e8f5e8; padding:15px;">
        <h4>ğŸ“¦ Contenu du Panier (<?= count($_SESSION['panier']) ?> articles)</h4>

        <?php if (empty($_SESSION['panier'])): ?>
            <p>Votre panier est vide</p>
        <?php else: ?>
            <?php foreach ($_SESSION['panier'] as $index => $produit): ?>
                <div style="border-bottom:1px solid #ccc; padding:10px 0;">
                    <strong><?= htmlspecialchars($produit['nom']) ?></strong><br>
                    Prix: <?= number_format($produit['prix'], 2) ?> â‚¬<br>
                    AjoutÃ© Ã : <?= $produit['date_ajout'] ?>
                </div>
            <?php endforeach; ?>

            <div style="margin-top:10px; padding:10px; background:#2ecc71; color:white;">
                <strong>ğŸ’° Total: <?= number_format($total, 2) ?> â‚¬</strong>
            </div>
        <?php endif; ?>

        <?php if (!empty($_SESSION['panier'])): ?>
            <form method="post" style="margin-top:10px;">
                <button type="submit" name="vider_panier" style="background:#e74c3c; color:white;">
                    ğŸ—‘ï¸ Vider le panier
                </button>
            </form>
        <?php endif; ?>
    </div>

    <!-- ğŸ§  TEST PÃ‰DAGOGIQUE : -->
    <div style="margin-top:20px; padding:15px; background:#fff3cd;">
        <strong>ğŸ’¡ Testez :</strong> Ouvrez un nouvel onglet et revenez â†’ Le panier est toujours lÃ  !<br>
        <strong>Les sessions persistent pendant toute votre navigation.</strong>
    </div>
</body>
</html>
```

---

## ğŸ”„ 9. Pattern PRG : Ã‰viter les Re-soumissions

**ScÃ©nario :** Formulaire de commande avec confirmation

```php
<?php
// prg_commande.php
session_start();

// ğŸ¯ RÃ‰CUPÃ‰RATION DU MESSAGE FLASH
$confirmation = '';
if (isset($_SESSION['confirmation_commande'])) {
    $confirmation = $_SESSION['confirmation_commande'];
    unset($_SESSION['confirmation_commande']);
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ›ï¸ Passer une Commande</h3>

    <?php if ($confirmation): ?>
        <div style="background:#d4edda; color:#155724; padding:15px; margin:10px 0;">
            <h4>âœ… <?= $confirmation ?></h4>
            <p>Votre commande a Ã©tÃ© enregistrÃ©e avec succÃ¨s.</p>
        </div>
    <?php endif; ?>

    <form action="prg_traitement.php" method="post">
        <p><input type="text" name="produit" placeholder="Nom du produit" required></p>
        <p><input type="number" name="quantite" placeholder="QuantitÃ©" min="1" required></p>
        <p><input type="email" name="email" placeholder="Votre email" required></p>
        <button type="submit">Confirmer la commande ğŸš€</button>
    </form>

    <!-- ğŸ§  EXPLICATION PRG : -->
    <div style="margin-top:20px; padding:15px; background:#d1ecf1;">
        <h4>ğŸ”„ Comprendre le Pattern PRG :</h4>
        <p><strong>Post-Redirect-Get</strong> Ã©vite de renvoyer le formulaire en actualisant.</p>
        <p><strong>Testez :</strong> Soumettez le formulaire puis actualisez la page â†’ Pas de double commande !</p>
    </div>
</body>
</html>
```

```php
<?php
// prg_traitement.php
session_start();

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // ğŸ¯ TRAITEMENT DE LA COMMANDE
    $produit = htmlspecialchars($_POST['produit']);
    $quantite = intval($_POST['quantite']);

    // Simulation traitement
    sleep(1); // Simule un traitement long

    // ğŸ¯ STOCKAGE DANS LA SESSION
    $_SESSION['confirmation_commande'] = "Commande de $quantite $produit confirmÃ©e !";

    // ğŸ¯ REDIRECTION PRG
    header("Location: prg_commande.php");
    exit;
}
?>
```

---

## ğŸ’« 10. Messages Flash : Les Notifications Temporaires

**ScÃ©nario :** SystÃ¨me de notifications complet

```php
<?php
// flash_system.php
session_start();

// ğŸ¯ SYSTÃˆME DE MESSAGES FLASH
class FlashMessage {
    public static function set($type, $message) {
        $_SESSION['flash'][$type] = $message;
    }

    public static function display() {
        if (empty($_SESSION['flash'])) return '';

        $html = '';
        foreach ($_SESSION['flash'] as $type => $message) {
            $styles = [
                'success' => 'background:#d4edda; color:#155724; border:1px solid #c3e6cb;',
                'error' => 'background:#f8d7da; color:#721c24; border:1px solid #f5c6cb;',
                'warning' => 'background:#fff3cd; color:#856404; border:1px solid #ffeaa7;',
                'info' => 'background:#d1ecf1; color:#0c5460; border:1px solid #bee5eb;'
            ];

            $html .= "<div style='{$styles[$type]}; padding:15px; margin:10px 0; border-radius:5px;'>";
            $html .= "<strong>" . strtoupper($type) . ":</strong> $message";
            $html .= "</div>";
        }

        // Nettoyage aprÃ¨s affichage
        $_SESSION['flash'] = [];
        return $html;
    }
}

// ğŸ¯ TRAITEMENT DES ACTIONS
if ($_POST) {
    $action = $_POST['action'] ?? '';

    switch ($action) {
        case 'success':
            FlashMessage::set('success', 'OpÃ©ration rÃ©ussie avec succÃ¨s !');
            break;
        case 'error':
            FlashMessage::set('error', 'Une erreur est survenue lors du traitement.');
            break;
        case 'warning':
            FlashMessage::set('warning', 'Attention : Cette action est irrÃ©versible.');
            break;
        case 'info':
            FlashMessage::set('info', 'Nouvelle fonctionnalitÃ© disponible !');
            break;
    }

    header("Location: " . $_SERVER['PHP_SELF']);
    exit;
}
?>
<!DOCTYPE html>
<html>
<body>
    <h3>ğŸ”” SystÃ¨me de Notifications</h3>

    <!-- AFFICHAGE DES MESSAGES FLASH -->
    <?= FlashMessage::display() ?>

    <!-- BOUTONS DE TEST -->
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin:20px 0;">
        <form method="post"><button type="submit" name="action" value="success" style="background:#28a745; color:white; width:100%; padding:10px;">âœ… SuccÃ¨s</button></form>
        <form method="post"><button type="submit" name="action" value="error" style="background:#dc3545; color:white; width:100%; padding:10px;">âŒ Erreur</button></form>
        <form method="post"><button type="submit" name="action" value="warning" style="background:#ffc107; color:black; width:100%; padding:10px;">âš ï¸ Avertissement</button></form>
        <form method="post"><button type="submit" name="action" value="info" style="background:#17a2b8; color:white; width:100%; padding:10px;">â„¹ï¸ Information</button></form>
    </div>

    <!-- ğŸ¯ EXPLICATION PÃ‰DAGOGIQUE -->
    <div style="background:#f8f9fa; padding:15px; border-radius:5px;">
        <h4>ğŸ’¡ Messages Flash en Pratique :</h4>
        <p><strong>Utilisation rÃ©elle :</strong> Confirmation d'actions, erreurs de formulaire, notifications systÃ¨me.</p>
        <p><strong>Avantage :</strong> Les messages disparaissent aprÃ¨s affichage â†’ Pas de doublons.</p>
        <p><strong>Testez :</strong> Cliquez sur un bouton, le message s'affiche. Actualisez â†’ il disparaÃ®t !</p>
    </div>
</body>
</html>
```

---

## ğŸ† 11. Mini-Projet : SystÃ¨me d'Authentification Complet

**ScÃ©nario :** Application de gestion de tÃ¢ches avec authentification

```php
<?php
// auth_system.php
session_start();

// ğŸ¯ SIMULATION BASE DE DONNÃ‰ES
$utilisateurs = [
    'admin' => [
        'password' => '1234',
        'email' => 'admin@entreprise.com',
        'role' => 'administrateur'
    ],
    'marie' => [
        'password' => 'password',
        'email' => 'marie@entreprise.com', 
        'role' => 'utilisateur'
    ]
];

// ğŸ¯ FONCTION D'AUTHENTIFICATION
function authentifier($username, $password, $utilisateurs) {
    if (isset($utilisateurs[$username]) && $utilisateurs[$username]['password'] === $password) {
        $_SESSION['user'] = [
            'username' => $username,
            'email' => $utilisateurs[$username]['email'],
            'role' => $utilisateurs[$username]['role'],
            'login_time' => time()
        ];

        // Cookie de derniÃ¨re connexion
        setcookie('dernier_utilisateur', $username, time() + (365 * 24 * 3600));

        return true;
    }
    return false;
}

// ğŸ¯ DÃ‰CONNEXION
if (isset($_GET['logout'])) {
    session_destroy();
    setcookie('dernier_utilisateur', '', time() - 3600);
    header("Location: auth_system.php");
    exit;
}

// ğŸ¯ TRAITEMENT CONNEXION
$erreur = '';
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['login'])) {
    $username = trim($_POST['username']);
    $password = trim($_POST['password']);

    if (authentifier($username, $password, $utilisateurs)) {
        header("Location: auth_system.php");
        exit;
    } else {
        $erreur = "âŒ Identifiants incorrects";
    }
}
?>
<!DOCTYPE html>
<html>
<head>
    <title>ğŸ” SystÃ¨me d'Authentification</title>
    <style>
        .container { max-width: 600px; margin: 50px auto; padding: 20px; }
        .form-group { margin: 15px 0; }
        .btn { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; }
        .dashboard { background: #f8f9fa; padding: 20px; border-radius: 8px; }
        .error { color: #dc3545; padding: 10px; background: #f8d7da; }
    </style>
</head>
<body>
    <div class="container">
        <?php if (!isset($_SESSION['user'])): ?>
            <!-- ğŸ¯ FORMULAIRE DE CONNEXION -->
            <h2>ğŸ” Connexion Ã  l'Application</h2>

            <?php if ($erreur): ?>
                <div class="error"><?= $erreur ?></div>
            <?php endif; ?>

            <?php if (isset($_COOKIE['dernier_utilisateur'])): ?>
                <div style="background: #d1ecf1; padding: 10px; margin: 10px 0;">
                    <strong>ğŸ’¡ Rappel :</strong> DerniÃ¨re connexion avec <strong><?= $_COOKIE['dernier_utilisateur'] ?></strong>
                </div>
            <?php endif; ?>

            <form method="post">
                <div class="form-group">
                    <label><strong>ğŸ‘¤ Utilisateur :</strong></label>
                    <input type="text" name="username" value="<?= $_COOKIE['dernier_utilisateur'] ?? '' ?>" required 
                           style="width:100%; padding:8px; margin-top:5px;">
                </div>

                <div class="form-group">
                    <label><strong>ğŸ”’ Mot de passe :</strong></label>
                    <input type="password" name="password" required 
                           style="width:100%; padding:8px; margin-top:5px;">
                </div>

                <button type="submit" name="login" class="btn">Se connecter ğŸš€</button>
            </form>

            <!-- ğŸ§  COMPTES DE TEST -->
            <div style="margin-top: 30px; padding: 15px; background: #fff3cd;">
                <h4>ğŸ§ª Comptes de test :</h4>
                <p><strong>Admin :</strong> admin / 1234</p>
                <p><strong>Utilisateur :</strong> marie / password</p>
            </div>

        <?php else: ?>
            <!-- ğŸ¯ TABLEAU DE BORD -->
            <div class="dashboard">
                <h2>ğŸ“Š Tableau de Bord</h2>

                <div style="background: white; padding: 15px; border-radius: 5px; margin: 15px 0;">
                    <h3>ğŸ‘‹ Bienvenue, <?= $_SESSION['user']['username'] ?> !</h3>
                    <p><strong>ğŸ“§ Email :</strong> <?= $_SESSION['user']['email'] ?></p>
                    <p><strong>ğŸ¯ RÃ´le :</strong> <?= $_SESSION['user']['role'] ?></p>
                    <p><strong>ğŸ•’ ConnectÃ© depuis :</strong> <?= date('H:i:s', $_SESSION['user']['login_time']) ?></p>
                    <p><strong>â° DurÃ©e de session :</strong> <?= time() - $_SESSION['user']['login_time'] ?> secondes</p>
                </div>

                <!-- ğŸ¯ FONCTIONNALITÃ‰S SELON RÃ”LE -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                        <h4>âœ… Mes TÃ¢ches</h4>
                        <p>GÃ©rer mes tÃ¢ches quotidiennes</p>
                        <button style="background: #28a745; color: white; padding: 8px 15px; border: none; border-radius: 3px;">
                            AccÃ©der â€º
                        </button>
                    </div>

                    <?php if ($_SESSION['user']['role'] === 'administrateur'): ?>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 5px;">
                            <h4>âš™ï¸ Administration</h4>
                            <p>Gestion des utilisateurs</p>
                            <button style="background: #17a2b8; color: white; padding: 8px 15px; border: none; border-radius: 3px;">
                                Administrer â€º
                            </button>
                        </div>
                    <?php endif; ?>
                </div>

                <!-- ğŸ¯ INFORMATIONS DE SESSION -->
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 20px;">
                    <h4>ğŸ” Informations de Session</h4>
                    <p><strong>ID de session :</strong> <?= session_id() ?></p>
                    <p><strong>Variables de session :</strong></p>
                    <pre style="background: white; padding: 10px; border-radius: 3px;"><?php print_r($_SESSION); ?></pre>
                </div>

                <a href="?logout=1" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #dc3545; color: white; text-decoration: none; border-radius: 4px;">
                    ğŸšª Se dÃ©connecter
                </a>
            </div>
        <?php endif; ?>
    </div>
</body>
</html>
```

---

## ğŸ¯ CompÃ©tences Acquises (Version RÃ©elle)

**Vous savez maintenant :**

- âœ… **Architecturer** des applications web complÃ¨tes
- âœ… **SÃ©curiser** les formulaires et les authentifications  
- âœ… **GÃ©rer** la persistance des donnÃ©es (sessions, cookies)
- âœ… **ImplÃ©menter** des patterns professionnels (PRG, Messages Flash)
- âœ… **CrÃ©er** des interfaces utilisateur dynamiques et interactives
- âœ… **Comprendre** le cycle complet requÃªte/rÃ©ponse HTTP

**Vous Ãªtes passÃ© de "dÃ©veloppeur PHP" Ã  "architecte web" !** ğŸ‰
