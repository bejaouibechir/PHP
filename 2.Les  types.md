# PHP - Les types de données

Le terme **« types de données »** désigne le classement des données en catégories distinctes en PHP. 

## Liste des types de données

- **Entiers (Integers)**

- **Doubles (flottants)**

- **Booléens (Booleans)**

- **NULL**

- **Chaînes (Strings)**

- **Tableaux (Arrays)**: nommées et indexées d’autres valeurs.

- **Objets (Objects)**: de classes définies par le programmeur, pouvant contenir des valeurs et des méthodes propres à la classe.

- **Ressources (Resources)**: Variables spéciales contenant des références vers des ressources externes à PHP (connexion base de données, flux fichier, etc.).
1. Les cinq premiers sont des **types simples**, 

2. Les deux suivants (tableaux et objets) sont des **types composés**  *Les types composés peuvent contenir d’autres valeurs de n’importe quel type, contrairement aux types simples.*

Dans ce chapitre, nous allons détailler tous ces types natifs de PHP.

## Le type Integer (entier) en PHP

Un nombre entier sans virgule (ex. `4195`)  est de type `int` en PHP. C’est le type le plus simple. Il représente des nombres entiers, positifs ou négatifs.

- Un `int` appartient à l’ensemble ℤ = {…, -2, -1, 0, 1, 2, …}.
- Il peut s’écrire en base 10 (décimale), 16 (hexadécimale), 8 (octale) ou 2 (binaire).

**Notation :**

- Octale → préfixe `0o` ou `0O`
- Hexadécimale → préfixe `0x`
- Binaire → préfixe `0b`

Exemples :

```php
// Décimal
$decimal = 201;

// Octal
$octal = 0o10;    // ≡ 8 en décimal

// Hexadécimal
$hexa = 0xFF;     // ≡ 255

// Binaire
$binary = 0b1010; // ≡ 10
```

## Le type Double (flottant) en PHP

Les variables `double` représentent des nombres à virgule flottante (aussi appelés « floats », « doubles » ou « nombres réels »).

```php
$positif = 1.55;
$negatif = -123.0;
$zero    = 0.0;
```

### Notation scientifique

PHP autorise la notation scientifique avec `E` ou `e` :

```php
1.2e3   // 1200
7E-10   // 0.0000000007
```

Par défaut, l’affichage supprime les décimales inutiles :

```php
$many = 2.2888800;
$many_2 = 2.2111200;
$few = $many + $many_2;
echo "$many + $many_2 = $few"; // → 2.28888 + 2.21112 = 4.5
```

## Le type Boolean en PHP

Le type `bool` ne possède que deux valeurs : `true` ou `false`.

```php
$oui = true;
$non = false;
```

On peut aussi utiliser `1` et `0` :

```php
$oui = 1;  // true
$non = 0;  // false
```

### Interprétation des autres types comme booléen

| Type            | Valeur → `false`                                                           | Sinon → `true`                    |
| --------------- | -------------------------------------------------------------------------- | --------------------------------- |
| `int` / `float` | `0`, `0.0`, `-0.0`                                                         | tout autre nombre                 |
| `string`        | `""` (chaîne vide) ou `"0"`                                                | toute autre chaîne                |
| `NULL`          | toujours `false`                                                           | –                                 |
| `array`         | tableau vide `[]`                                                          | tableau non vide                  |
| `object`        | objet sans propriétés                                                      | objet avec au moins une propriété |
| ressource       | ressource invalide (certaines fonctions retournent `false` en cas d’échec) | ressource valide                  |

**Attention** : ne jamais utiliser de flottants comme booléens.

## Le type String (chaîne) en PHP

Une chaîne est une suite de caractères. En PHP, un caractère = un octet → jeu de 256 caractères maximum (pas de support Unicode natif).

```php
$str1 = "Ceci est une chaîne en guillemets doubles";
$str2 = 'Ceci est une chaîne un peu plus longue en quotes simples';
```

### Guillemets simples vs doubles

- **Guillemets simples** → littéral (pas d’interprétation)
- **Guillemets doubles** → interprétation des variables + séquences d’échappement

```php
$var = "monde";
echo 'Bonjour $var\n'; // → Bonjour $var\n
echo "Bonjour $var\n"; // → Bonjour monde (et saut de ligne)
```

### Séquences d’échappement

```\n``` → saut de ligne  
```\r``` → retour chariot  
```\t``` → tabulation  
```\$``` → dollar littéral  
```\"``` → guillemet double  
```\\``` → antislash

### Heredoc & Nowdoc

```php
// Heredoc (interprétation)
$xml = <<<XML
<channel>
    <title>Quoi manger ce soir ?</title>
</channel>
XML;

// Nowdoc (littéral)
echo <<<'TXT'
Pas d'interprétation ici, même pas $var
TXT;
```

## Le type NULL

`NULL` représente l’absence de valeur.

```php
$rien = NULL;     // ou null (insensible à la casse)
unset($var);      // $var devient NULL
```

Propriétés :

- Évalué à `false` dans un contexte booléen
- `isset($var)` retourne `false`

## Le type Array (tableau)

Un tableau PHP est une map ordonnée clé → valeur.

```php
// Syntaxe longue
$arr = array("cle" => "valeur");

// Syntaxe courte (recommandée)
$arr = [
    "prenom" => "Marie  "Jean",
    42 => "réponse"
];
```

Tableaux indexés, associatifs, multidimensionnels… tout est possible.

## Le type Object

Instance d’une classe définie par le programmeur.

```php
class Salutation {
    public function direBonjour() {
        echo "Bonjour le monde !";
    }
}
$obj = new Salutation();
$obj->direBonjour();
```

## Le type Resource

Variable spéciale contenant une référence vers une ressource externe (fichier, connexion DB, curl, etc.).

```php
$fp = fopen("fichier.txt", "r"); // $fp est une resource de type stream
```

---

# PHP - Conversion de types (Type Casting)

La **conversion de type** consiste à transformer une donnée d’un type vers un autre.

PHP étant faiblement typé, certaines conversions sont **implicites** (juggling), d’autres **explicites** (casting).

## Conversion implicite (Type Juggling)

```php
$a = 10;
$b = '20';
$c = $a + $b; // $b devient int → $c = 30
$d = $a . $b; // $a devient string → $d = "1020"
```

## Opérateurs de casting explicite

```php
(int) ou (integer) → entier
(float), (double), (real) → flottant
(string) → chaîne
(bool) ou (boolean) → booléen
(array) → tableau
(object) → objet
```

### Exemples

```php
$prix = "99.95";
$entier = (int)$prix;    // 99
$flottant = (float)$prix; // 99.95
```

## Fonctions de conversion

- `intval($var, $base)` → entier
- `floatval($var)` ou `doubleval($var)` → flottant
- `strval($var)` → chaîne

```php
echo intval('042', 8); // 34 (octal)
echo floatval('1.23E-4'); // 0.000123
```

---

# PHP - Type Juggling (auto-conversion)

PHP change automatiquement le type d’une variable selon le contexte. C’est pratique… mais peut créer des failles de sécurité si on ne fait pas attention.

### Vulnérabilité classique

```php
"0e123456" == 0    // true (notation scientifique → 0 × 10^123456)
"123abc" == 123    // true (PHP ignore le texte après les chiffres)
```

**Solution** : toujours utiliser l’opérateur strict `===`

```php
"123abc" === 123   // false (types différents)
```

---

# PHP - Chaînes de caractères (Strings)

## Guillemets simples

```php
echo 'Ligne\n non interprétée'; // → Ligne\n non interprétée
```

## Guillemets doubles

```php
$nom = "Marie";
echo "Bonjour $nom"; // → Bonjour Marie
```

## Fonctions utiles

```php
strlen("PHP");     // 3
strpos("Bonjour monde", "monde"); // 8
```

---

# PHP - Booléens

```php
$actif = true;
$inactif = false;
```

Opérateurs logiques : `&&`, `||`, `!`, `xor`

Comparaison stricte : `===`

---

# PHP - Entiers (Integers)

```php
$grand = 9_223_372_036_854_775_807; // PHP_INT_MAX (64 bits)
echo PHP_INT_MAX; // 9223372036854775807
```

Division entière : `intdiv(10, 3)` → `3`

---

# PHP - Division entière (`intdiv()`)

```php
intdiv(10, 3);   // 3
intdiv(-10, 3);  // -3
intdiv(10, -3);  // -3
intdiv(-10, -3); // 3
```

---

# PHP - Date & Heure

```php
time();                    // timestamp actuel
date("d/m/Y H:i");         // 08/11/2025 14:30
strtotime("next Monday");  // timestamp du lundi prochain
```

---

# PHP - Déclarations de types scalaires (PHP 7+)

```php
declare(strict_types=1); // mode strict

function addition(int $a, int $b): int {
    return $a + $b;
}
```

---

# PHP - Types de retour

```php
function diviser(float $a, float $b): float {
    return $a / $b;
}
```

---

# PHP - Types spéciaux

## Resource

```php
$fp = fopen("log.txt", "a");
var_dump(get_resource_type($fp)); // "stream"
```

## NULL

```php
$rien = null;
var_dump($rien); // NULL
```
