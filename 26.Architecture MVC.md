

# üß≠ Atelier PHP MVC ‚Äî Version am√©lior√©e & compl√®te

## üéØ Objectif

Cr√©er un mini-framework MVC en PHP :

- Bas√© sur **Composer (autoload PSR-4)**

- Avec un **routeur simple**

- Des **contr√¥leurs d√©di√©s** (`HomeController`, `AboutController`)

- Des **vues soign√©es et responsives** avec un peu de CSS int√©gr√©

---

## 1Ô∏è‚É£ Pr√©parer l‚Äôenvironnement

### Sous Windows ou Linux :

```bash
php -v
composer -V
```

Si Composer n‚Äôest pas install√© :  
üëâ installez-le via https://getcomposer.org/download/

---

## 2Ô∏è‚É£ Cr√©er le projet

```bash
mkdir MON-MVC && cd MON-MVC
mkdir -p public src/Controllers src/Support views
composer init -n
```

---

## 3Ô∏è‚É£ Configurer Composer

Cr√©er le fichier **composer.json** √† la racine :

```json
{
  "name": "mon/mvc",
  "type": "project",
  "autoload": {
    "psr-4": {
      "App\\": "src/"
    }
  }
}
```

Puis ex√©cuter :

```bash
composer dump-autoload
```

---

## 4Ô∏è‚É£ Cr√©er le routeur

Cr√©er le fichier **src/Router.php** :

```php
<?php
namespace App;

/**
 * Routeur minimaliste capable de g√©rer GET et POST.
 */
final class Router
{
    private array $routes = ['GET' => [], 'POST' => []];

    public function get(string $path, callable|array $action): void
    {
        $this->routes['GET'][$this->normalize($path)] = $action;
    }

    public function post(string $path, callable|array $action): void
    {
        $this->routes['POST'][$this->normalize($path)] = $action;
    }

    public function dispatch(string $method, string $requestUri): string
    {
        $path = $this->extractPath($requestUri);
        $action = $this->routes[$method][$path] ?? null;

        if (!$action) {
            http_response_code(404);
            return "<h1>404 - Page non trouv√©e</h1>";
        }

        if (is_array($action)) {
            [$class, $methodName] = $action;
            $instance = new $class();
            return (string)$instance->$methodName();
        }

        return (string)$action();
    }

    private function extractPath(string $uri): string
    {
        $path = parse_url($uri, PHP_URL_PATH) ?? '/';
        return $this->normalize($path);
    }

    private function normalize(string $path): string
    {
        if ($path !== '/' && str_ends_with($path, '/')) {
            $path = rtrim($path, '/');
        }
        return $path;
    }
}
```

---

## 5Ô∏è‚É£ Cr√©er le moteur de vue

Cr√©er **src/Support/View.php** :

```php
<?php
namespace App\Support;

final class View
{
    public static function make(string $name, array $data = []): string
    {
        $file = __DIR__ . '/../../views/' . $name . '.php';
        if (!is_file($file)) {
            throw new \RuntimeException("Vue '$name' introuvable.");
        }

        extract($data, EXTR_SKIP);
        ob_start();
        require $file;
        return (string)ob_get_clean();
    }
}
```

---

## 6Ô∏è‚É£ Cr√©er les contr√¥leurs

### üè† **HomeController**

Cr√©er **src/Controllers/HomeController.php** :

```php
<?php
namespace App\Controllers;

use App\Support\View;

final class HomeController
{
    public function index(): string
    {
        return View::make('home', [
            'title' => 'Accueil',
            'message' => 'Bienvenue sur votre mini-framework MVC PHP üéâ'
        ]);
    }

    public function contact(): string
    {
        return View::make('contact', [
            'title' => 'Contact',
            'feedback' => null
        ]);
    }

    public function submitContact(): string
    {
        $name = trim($_POST['name'] ?? '');
        $msg  = trim($_POST['message'] ?? '');
        $ok = ($name !== '' && $msg !== '');

        return View::make('contact', [
            'title' => 'Contact',
            'feedback' => $ok
                ? "Merci $name, votre message a √©t√© re√ßu avec succ√®s."
                : "Veuillez remplir tous les champs du formulaire."
        ]);
    }
}
```

---

### ‚ÑπÔ∏è **AboutController**

Cr√©er **src/Controllers/AboutController.php** :

```php
<?php
namespace App\Controllers;

use App\Support\View;

final class AboutController
{
    public function index(): string
    {
        return View::make('about', [
            'title' => '√Ä propos',
            'content' => 'Ce mini-framework MVC est une d√©monstration p√©dagogique pour comprendre la structure de base d‚Äôune application PHP moderne : routage, contr√¥leurs et vues.'
        ]);
    }
}
```

---

## 7Ô∏è‚É£ Cr√©er le point d‚Äôentr√©e (Front Controller)

Cr√©er **public/index.php** :

```php
<?php
declare(strict_types=1);

require_once __DIR__ . '/../vendor/autoload.php';

use App\Router;
use App\Controllers\HomeController;
use App\Controllers\AboutController;

$router = new Router();
$router->get('/', [HomeController::class, 'index']);
$router->get('/contact', [HomeController::class, 'contact']);
$router->post('/contact', [HomeController::class, 'submitContact']);
$router->get('/about', [AboutController::class, 'index']);

$method = $_SERVER['REQUEST_METHOD'] ?? 'GET';
$uri = $_SERVER['REQUEST_URI'] ?? '/';

echo $router->dispatch($method, $uri);
```

---

## 8Ô∏è‚É£ Cr√©er les vues (interface am√©lior√©e)

### üè† **views/home.php**

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title) ?></title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f9fafb; color: #333; }
    h1 { color: #0066cc; }
    nav a { margin-right: 15px; text-decoration: none; color: #0066cc; }
    nav a:hover { text-decoration: underline; }
    .container { max-width: 600px; margin: auto; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h1><?= htmlspecialchars($message) ?></h1>
    <nav>
      <a href="/">Accueil</a>
      <a href="/contact">Contact</a>
      <a href="/about">√Ä propos</a>
    </nav>
  </div>
</body>
</html>
```

---

### üí¨ **views/contact.php**

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title) ?></title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f2f4f8; color: #333; }
    form { max-width: 400px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; }
    button { margin-top: 15px; background: #007bff; color: #fff; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0056b3; }
    .msg { text-align: center; margin-bottom: 15px; font-weight: bold; color: #006600; }
    nav { text-align: center; margin-top: 20px; }
    nav a { margin: 0 10px; color: #007bff; text-decoration: none; }
    nav a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <?php if (!empty($feedback)): ?>
    <p class="msg"><?= htmlspecialchars($feedback) ?></p>
  <?php endif; ?>

  <form method="post" action="/contact">
    <label>Nom :</label>
    <input name="name" required>

    <label>Message :</label>
    <textarea name="message" required></textarea>

    <button type="submit">Envoyer</button>
  </form>

  <nav>
    <a href="/">Accueil</a> |
    <a href="/about">√Ä propos</a>
  </nav>
</body>
</html>
```

---

### ‚ÑπÔ∏è **views/about.php**

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title) ?></title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; background: #f9fafb; color: #333; }
    .box { max-width: 700px; margin: auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { color: #007bff; text-align: center; }
    p { line-height: 1.6; }
    nav { text-align: center; margin-top: 20px; }
    nav a { margin: 0 10px; color: #007bff; text-decoration: none; }
    nav a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="box">
    <h1><?= htmlspecialchars($title) ?></h1>
    <p><?= htmlspecialchars($content) ?></p>

    <nav>
      <a href="/">Accueil</a> |
      <a href="/contact">Contact</a>
    </nav>
  </div>
</body>
</html>
```

---

## ‚úÖ 9Ô∏è‚É£ Lancer le projet

Depuis la racine du projet :

```bash
php -S localhost:8000 -t public
```

### Testez :

- `http://localhost:8000/` ‚Üí Page d‚Äôaccueil

- `http://localhost:8000/contact` ‚Üí Formulaire

- `http://localhost:8000/about` ‚Üí Page √Ä propos



## It√©ration 3 : ajout du Mod√®le (stockage JSON)

## üéØ Objectif

- Introduire la couche **Mod√®le (M)** du sch√©ma MVC.

- Sauvegarder les messages du formulaire de contact dans un **fichier JSON**.

- Lire ces messages pour les afficher dans une page d√©di√©e.

- Conserver la logique claire et comment√©e.

---

## üèóÔ∏è 1Ô∏è‚É£ Nouvelle structure de dossiers

Ajoutez le dossier :

```bash
mkdir -p src/Models data
```

Votre projet devient :

```
MON-MVC/
 ‚îú‚îÄ public/
 ‚îÇ   ‚îî‚îÄ index.php
 ‚îú‚îÄ src/
 ‚îÇ   ‚îú‚îÄ Controllers/
 ‚îÇ   ‚îÇ   ‚îú‚îÄ HomeController.php
 ‚îÇ   ‚îÇ   ‚îî‚îÄ AboutController.php
 ‚îÇ   ‚îú‚îÄ Models/
 ‚îÇ   ‚îÇ   ‚îî‚îÄ MessageModel.php   ‚Üê nouveau
 ‚îÇ   ‚îú‚îÄ Support/
 ‚îÇ   ‚îÇ   ‚îî‚îÄ View.php
 ‚îÇ   ‚îî‚îÄ Router.php
 ‚îú‚îÄ views/
 ‚îÇ   ‚îú‚îÄ home.php
 ‚îÇ   ‚îú‚îÄ contact.php
 ‚îÇ   ‚îî‚îÄ about.php
 ‚îú‚îÄ data/
 ‚îÇ   ‚îî‚îÄ messages.json          ‚Üê stockage
 ‚îú‚îÄ composer.json
 ‚îî‚îÄ vendor/
```

---

## üß± 2Ô∏è‚É£ Cr√©er le mod√®le : `MessageModel`

Cr√©er le fichier **src/Models/MessageModel.php** :

```php
<?php
namespace App\Models;

/**
 * Mod√®le MessageModel
 * G√®re la persistance des messages dans un fichier JSON.
 */
final class MessageModel
{
    private string $file;

    public function __construct()
    {
        // Chemin vers le fichier de stockage
        $this->file = __DIR__ . '/../../data/messages.json';

        // Si le fichier n'existe pas, on le cr√©e avec un tableau vide
        if (!file_exists($this->file)) {
            file_put_contents($this->file, json_encode([]));
        }
    }

    /**
     * Enregistre un message dans le fichier JSON
     */
    public function save(string $name, string $message): void
    {
        $messages = $this->all();
        $messages[] = [
            'name' => $name,
            'message' => $message,
            'date' => date('Y-m-d H:i:s')
        ];
        file_put_contents($this->file, json_encode($messages, JSON_PRETTY_PRINT));
    }

    /**
     * R√©cup√®re tous les messages
     */
    public function all(): array
    {
        $content = file_get_contents($this->file);
        return json_decode($content, true) ?? [];
    }
}
```

---

## üß≠ 3Ô∏è‚É£ Modifier le contr√¥leur `HomeController`

Cr√©er ou modifier **src/Controllers/HomeController.php** ainsi :

```php
<?php
namespace App\Controllers;

use App\Support\View;
use App\Models\MessageModel;

/**
 * Contr√¥leur principal pour les pages d'accueil et contact.
 */
final class HomeController
{
    private MessageModel $model;

    public function __construct()
    {
        $this->model = new MessageModel();
    }

    /** Page d'accueil */
    public function index(): string
    {
        return View::make('home', [
            'title' => 'Accueil',
            'message' => 'Bienvenue sur votre mini-framework MVC avec mod√®le JSON üéâ'
        ]);
    }

    /** Formulaire de contact */
    public function contact(): string
    {
        return View::make('contact', [
            'title' => 'Contact',
            'feedback' => null
        ]);
    }

    /** Traitement du formulaire + enregistrement */
    public function submitContact(): string
    {
        $name = trim($_POST['name'] ?? '');
        $msg  = trim($_POST['message'] ?? '');

        if ($name !== '' && $msg !== '') {
            $this->model->save($name, $msg);
            $feedback = "Merci $name, votre message a √©t√© enregistr√© avec succ√®s !";
        } else {
            $feedback = "Veuillez remplir tous les champs.";
        }

        return View::make('contact', [
            'title' => 'Contact',
            'feedback' => $feedback
        ]);
    }

    /** Affiche tous les messages enregistr√©s */
    public function messages(): string
    {
        $messages = $this->model->all();

        return View::make('messages', [
            'title' => 'Messages re√ßus',
            'messages' => $messages
        ]);
    }
}
```

---

## üßæ 4Ô∏è‚É£ Cr√©er une nouvelle vue `views/messages.php`

Cr√©er le fichier **views/messages.php** :

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title) ?></title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f5f7fa; color: #333; }
    .container { max-width: 700px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { color: #007bff; text-align: center; }
    .msg { border-bottom: 1px solid #eee; padding: 10px 0; }
    .msg:last-child { border: none; }
    .author { font-weight: bold; color: #0056b3; }
    .date { font-size: 0.9em; color: #777; }
    nav { text-align: center; margin-top: 20px; }
    nav a { margin: 0 10px; text-decoration: none; color: #007bff; }
    nav a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="container">
    <h1><?= htmlspecialchars($title) ?></h1>

    <?php if (empty($messages)): ?>
      <p>Aucun message pour le moment.</p>
    <?php else: ?>
      <?php foreach ($messages as $m): ?>
        <div class="msg">
          <p class="author"><?= htmlspecialchars($m['name']) ?></p>
          <p><?= nl2br(htmlspecialchars($m['message'])) ?></p>
          <p class="date"><?= htmlspecialchars($m['date']) ?></p>
        </div>
      <?php endforeach; ?>
    <?php endif; ?>

    <nav>
      <a href="/">Accueil</a> |
      <a href="/contact">Contact</a>
    </nav>
  </div>
</body>
</html>
```

---

## ‚öôÔ∏è 5Ô∏è‚É£ Mettre √† jour le routeur

Dans **public/index.php**, ajouter la nouvelle route `/messages` :

```php
use App\Controllers\HomeController;
use App\Controllers\AboutController;

$router = new Router();
$router->get('/', [HomeController::class, 'index']);
$router->get('/contact', [HomeController::class, 'contact']);
$router->post('/contact', [HomeController::class, 'submitContact']);
$router->get('/messages', [HomeController::class, 'messages']);  // ‚úÖ nouveau
$router->get('/about', [AboutController::class, 'index']);
```

---

## üé® 6Ô∏è‚É£ Ajouter un lien vers la page "Messages"

Modifiez le bas de **views/contact.php** pour ajouter :

```html
<nav>
  <a href="/">Accueil</a> |
  <a href="/about">√Ä propos</a> |
  <a href="/messages">Messages</a>
</nav>
```

---

## üöÄ 7Ô∏è‚É£ Tester le tout

Lancez :

```bash
php -S localhost:8000 -t public
```

Ensuite :

1. Allez sur `http://localhost:8000/contact`

2. Envoyez un message ‚Üí il sera ajout√© dans `data/messages.json`

3. Ouvrez `http://localhost:8000/messages` ‚Üí vous verrez la liste des messages

---

## ‚úÖ R√©sultat attendu

- Le formulaire envoie et enregistre les messages.

- Chaque message est stock√© dans `data/messages.json`.

- Vous pouvez consulter tous les messages sur la page `/messages`.

Excellent üëè  
Nous passons √† la **4·µâ it√©ration** : cr√©ation d‚Äôun **layout commun** (`views/layout.php`) et am√©lioration compl√®te de la **pr√©sentation HTML/CSS**.  
Ce layout servira de ‚Äútemplate de base‚Äù partag√© par toutes les vues (Home, Contact, About, Messages).  
Nous allons aussi uniformiser le style pour obtenir un rendu **propre, moderne et responsive**.

---

### It√©ration 4 : Layout commun + Design am√©lior√©

## Objectifs

- Introduire un **layout partag√©** pour √©viter la r√©p√©tition du `<html>`, `<head>` et `<nav>`.

- Uniformiser le **design** avec un style moderne et coh√©rent.

- Simplifier les vues pour qu‚Äôelles contiennent uniquement le **contenu sp√©cifique** √† chaque page.

---

## üß© 1Ô∏è‚É£ Cr√©er le layout commun

Cr√©er le fichier **views/layout.php** :

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title ?? 'Mon MVC') ?></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* --- Reset et style global --- */
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      background: #f5f7fa;
      color: #333;
    }

    header {
      background: #0078d7;
      color: white;
      padding: 15px 0;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    header h1 {
      margin: 0;
      font-size: 1.8rem;
    }

    nav {
      background: #005fa3;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      padding: 10px 0;
    }

    nav a {
      color: white;
      margin: 8px 15px;
      text-decoration: none;
      font-weight: 500;
    }

    nav a:hover {
      text-decoration: underline;
    }

    main {
      max-width: 800px;
      margin: 30px auto;
      background: white;
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    footer {
      text-align: center;
      padding: 15px;
      color: #555;
      font-size: 0.9rem;
      border-top: 1px solid #ddd;
      margin-top: 30px;
    }

    /* --- Formulaire --- */
    form { display: flex; flex-direction: column; gap: 10px; }
    label { font-weight: bold; }
    input, textarea {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
    }
    button {
      background: #0078d7;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      align-self: flex-start;
    }
    button:hover { background: #005fa3; }

    /* --- Messages --- */
    .message { border-bottom: 1px solid #eee; padding: 10px 0; }
    .message:last-child { border: none; }
    .author { font-weight: bold; color: #0078d7; }
    .date { color: #666; font-size: 0.85rem; }

    /* --- Feedback --- */
    .feedback { background: #e7f7e7; padding: 10px; border-radius: 5px; color: #1b5e20; font-weight: bold; margin-bottom: 15px; }

    /* --- Responsive --- */
    @media (max-width: 600px) {
      main { margin: 15px; padding: 15px; }
      header h1 { font-size: 1.4rem; }
      nav a { margin: 5px 8px; font-size: 0.9rem; }
    }
  </style>
</head>
<body>

  <header>
    <h1><?= htmlspecialchars($headerTitle ?? 'Mini MVC PHP') ?></h1>
  </header>

  <nav>
    <a href="/">Accueil</a>
    <a href="/contact">Contact</a>
    <a href="/messages">Messages</a>
    <a href="/about">√Ä propos</a>
  </nav>

  <main>
    <?= $content ?? '' ?>
  </main>

  <footer>
    ¬© <?= date('Y') ?> ‚Äì D√©monstration MVC en PHP | Formateur : Bechir Bejaoui
  </footer>

</body>
</html>
```

---

## üß± 2Ô∏è‚É£ Modifier le moteur de vue pour g√©rer le layout

√âditer **src/Support/View.php** :

```php
<?php
namespace App\Support;

/**
 * Moteur de rendu avec support de layout global.
 */
final class View
{
    public static function make(string $name, array $data = []): string
    {
        $viewFile = __DIR__ . '/../../views/' . $name . '.php';
        $layoutFile = __DIR__ . '/../../views/layout.php';

        if (!is_file($viewFile)) {
            throw new \RuntimeException("Vue '$name' introuvable.");
        }

        extract($data, EXTR_SKIP);

        // Capture du contenu sp√©cifique de la vue
        ob_start();
        require $viewFile;
        $content = ob_get_clean();

        // Injection dans le layout commun
        ob_start();
        require $layoutFile;
        return (string) ob_get_clean();
    }
}
```

---

## üß© 3Ô∏è‚É£ R√©√©crire les vues sp√©cifiques (plus l√©g√®res)

### üè† **views/home.php**

```php
<?php
$headerTitle = 'Accueil';
$title = 'Bienvenue';
?>
<h2><?= htmlspecialchars($title) ?></h2>
<p>Bienvenue sur votre mini-framework MVC avec mod√®le JSON, layout commun et design moderne üéâ</p>
<p>Utilisez le menu ci-dessus pour naviguer entre les pages.</p>
```

---

### üí¨ **views/contact.php**

```php
<?php
$headerTitle = 'Contact';
?>
<h2>Contact</h2>

<?php if (!empty($feedback)): ?>
  <div class="feedback"><?= htmlspecialchars($feedback) ?></div>
<?php endif; ?>

<form method="post" action="/contact">
  <label>Nom :</label>
  <input name="name" required>

  <label>Message :</label>
  <textarea name="message" required></textarea>

  <button type="submit">Envoyer</button>
</form>
```

---

### üì¨ **views/messages.php**

```php
<?php
$headerTitle = 'Messages';
?>
<h2>Messages re√ßus</h2>

<?php if (empty($messages)): ?>
  <p>Aucun message enregistr√© pour le moment.</p>
<?php else: ?>
  <?php foreach ($messages as $m): ?>
    <div class="message">
      <p class="author"><?= htmlspecialchars($m['name']) ?></p>
      <p><?= nl2br(htmlspecialchars($m['message'])) ?></p>
      <p class="date"><?= htmlspecialchars($m['date']) ?></p>
    </div>
  <?php endforeach; ?>
<?php endif; ?>
```

---

### ‚ÑπÔ∏è **views/about.php**

```php
<?php
$headerTitle = '√Ä propos';
?>
<h2>√Ä propos</h2>
<p>
  Ce mini-framework MVC a √©t√© con√ßu √† des fins p√©dagogiques pour comprendre la structure typique d‚Äôune application PHP :
</p>
<ul>
  <li><strong>Mod√®le (Model)</strong> : stockage et gestion des donn√©es JSON.</li>
  <li><strong>Vue (View)</strong> : interface HTML g√©n√©r√©e dynamiquement.</li>
  <li><strong>Contr√¥leur (Controller)</strong> : logique de traitement et liaison entre les deux.</li>
</ul>
<p>
  Vous pouvez facilement √©tendre ce projet vers une base SQLite, MySQL ou une API REST.
</p>
```

---

## ‚öôÔ∏è 4Ô∏è‚É£ Rien √† changer c√¥t√© routeur ni mod√®les

Votre **public/index.php** et **src/Models/MessageModel.php** restent identiques √† l‚Äôit√©ration pr√©c√©dente.

---

## üöÄ 5Ô∏è‚É£ Tester

```bash
php -S localhost:8000 -t public
```

### ‚û§ Ouvrir :

- `http://localhost:8000/` ‚Üí page d‚Äôaccueil

- `http://localhost:8000/contact` ‚Üí formulaire stylis√©

- `http://localhost:8000/messages` ‚Üí liste des messages

- `http://localhost:8000/about` ‚Üí pr√©sentation du projet

---

## ‚úÖ R√©sultat attendu

üé® **Interface moderne et uniforme** :

- En-t√™te bleue avec titre du site

- Barre de navigation responsive

- Contenu centr√© avec cartes et ombres

- Footer discret avec signature

üíæ **Structure MVC compl√®te** :

- Contr√¥leurs, Mod√®les, Vues, Routeur

- Layout partag√©

- Stockage JSON

Parfait üí™ excellente d√©cision ‚Äî c‚Äôest exactement ce qu‚Äôil faut faire pour rendre votre mini-MVC plus professionnel et pr√™t pour un vrai d√©ploiement.  
Nous allons donc passer √† **l‚Äôit√©ration 5**, qui consiste √† **externaliser tout le CSS** dans un fichier s√©par√© (`public/css/style.css`) et √† **adapter le layout** pour le charger automatiquement.

---

### It√©ration 5 : Externalisation du CSS

## üéØ Objectif

- Cr√©er un fichier CSS externe.

- Simplifier `views/layout.php`.

- Faciliter la maintenance et la r√©utilisation du style.

---

## üß± 1Ô∏è‚É£ Cr√©er le dossier des assets

Depuis la racine du projet :

```bash
mkdir -p public/css
```

---

## üé® 2Ô∏è‚É£ Cr√©er le fichier **public/css/style.css**

```css
/* --- Reset et style global --- */
* { box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Arial, sans-serif;
  margin: 0;
  background: #f5f7fa;
  color: #333;
}

/* --- Header --- */
header {
  background: #0078d7;
  color: white;
  padding: 15px 0;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
header h1 {
  margin: 0;
  font-size: 1.8rem;
}

/* --- Navigation --- */
nav {
  background: #005fa3;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  padding: 10px 0;
}
nav a {
  color: white;
  margin: 8px 15px;
  text-decoration: none;
  font-weight: 500;
}
nav a:hover {
  text-decoration: underline;
}

/* --- Contenu principal --- */
main {
  max-width: 800px;
  margin: 30px auto;
  background: white;
  border-radius: 10px;
  padding: 25px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
h2 {
  color: #0078d7;
  border-bottom: 2px solid #0078d7;
  padding-bottom: 8px;
}

/* --- Footer --- */
footer {
  text-align: center;
  padding: 15px;
  color: #555;
  font-size: 0.9rem;
  border-top: 1px solid #ddd;
  margin-top: 30px;
}

/* --- Formulaire --- */
form {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
label {
  font-weight: bold;
}
input, textarea {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 5px;
  width: 100%;
}
button {
  background: #0078d7;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
  align-self: flex-start;
}
button:hover {
  background: #005fa3;
}

/* --- Messages --- */
.message {
  border-bottom: 1px solid #eee;
  padding: 10px 0;
}
.message:last-child {
  border: none;
}
.author {
  font-weight: bold;
  color: #0078d7;
}
.date {
  color: #666;
  font-size: 0.85rem;
}

/* --- Feedback --- */
.feedback {
  background: #e7f7e7;
  padding: 10px;
  border-radius: 5px;
  color: #1b5e20;
  font-weight: bold;
  margin-bottom: 15px;
}

/* --- Responsive --- */
@media (max-width: 600px) {
  main { margin: 15px; padding: 15px; }
  header h1 { font-size: 1.4rem; }
  nav a { margin: 5px 8px; font-size: 0.9rem; }
}
```

---

## üß© 3Ô∏è‚É£ Modifier le layout pour charger ce fichier CSS

Ouvrir **views/layout.php** et remplacer la section `<head>` :

```php
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title><?= htmlspecialchars($title ?? 'Mon MVC') ?></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

  <header>
    <h1><?= htmlspecialchars($headerTitle ?? 'Mini MVC PHP') ?></h1>
  </header>

  <nav>
    <a href="/">Accueil</a>
    <a href="/contact">Contact</a>
    <a href="/messages">Messages</a>
    <a href="/about">√Ä propos</a>
  </nav>

  <main>
    <?= $content ?? '' ?>
  </main>

  <footer>
    ¬© <?= date('Y') ?> ‚Äì D√©monstration MVC PHP avec Layout et CSS externe
  </footer>

</body>
</html>
```

> ‚úÖ Note : le chemin `/css/style.css` est correct car le serveur PHP int√©gr√© (et Apache/Nginx ensuite) a `public/` comme racine.

---

## ‚öôÔ∏è 4Ô∏è‚É£ Aucune modification n√©cessaire ailleurs

- Les **vues** (home, contact, about, messages) fonctionnent sans changement.

- Le **router**, les **contr√¥leurs** et les **mod√®les** restent identiques.

- Le **CSS** externe est maintenant charg√© automatiquement via le layout.

---

## üöÄ 5Ô∏è‚É£ Tester

Depuis la racine du projet :

```bash
php -S localhost:8000 -t public
```

Puis :

- `http://localhost:8000/`

- `http://localhost:8000/contact`

- `http://localhost:8000/messages`

- `http://localhost:8000/about`

---

## ‚úÖ R√©sultat attendu

- Design **moderne, coh√©rent et centralis√©** dans un seul fichier `style.css`.

- **Vues propres** sans r√©p√©tition de style.

- **Layout unique** pour toutes les pages.

- Pr√™t √† √©voluer vers un th√®me professionnel (Bootstrap, Tailwind, etc.).
