# Access √† la base de donn√©es en MVC



**üèóÔ∏è Le Mod√®le MVC (Model-View-Controller)**

**MVC** (Model-View-Controller) est un **mod√®le d'architecture logicielle** extr√™mement populaire, massivement adopt√© par les frameworks PHP comme **Laravel** et **Symfony**.

---

### üéØ **La s√©paration des responsabilit√©s :**

**üìä MOD√àLE** - G√®re la **structure des donn√©es** et la logique m√©tier  
*(Base de donn√©es, r√®gles m√©tier)*

**üé® VUE** - G√®re **l'interface utilisateur** et la pr√©sentation  
*(HTML, CSS, templates)*

**‚öôÔ∏è CONTR√îLEUR** - Joue le r√¥le **d'interm√©diaire**  
*(Re√ßoit les entr√©es, traite avec le mod√®le, renvoie √† la vue)*

---

### üîÑ **L'√©cosyst√®me MVC :**

La **Vue** sert d'interface graphique  
Le **Mod√®le** agit comme back-end  
Le **Contr√¥leur** fait office d'adaptateur intelligent

Ces trois composants **interconnect√©s** √©changent des donn√©es et communiquent entre eux pour former une application coh√©rente.

```php
<!DOCTYPE html>
<html>
<head>
   <title>View (User Interface)</title>
   <link rel="stylesheet" href="style.css">
</head>
<body>
   <form id="mysearch" action="controller.php" method="POST">
      <input type="text" id = "nm" name="search" required>
      <input type="submit" value="Search">
   </form>
   <div id="results"></div>
   <script>
      let results = document.getElementById("results");
      results.innerHTML = "";
   </script>
   <?php
      session_start();
      if (isset($_SESSION['result'])) {
         $arr=$_SESSION['result'];

         foreach ($arr as $obj) {?>
            <script>
               results.innerHTML += "<div><?php echo $obj['id'] . "-" . 
                  $obj['name'] . "</div>"; ?>";
            </script>
            <?php
         }
      }
   ?>
</body>
</html>
```

Le script du contr√¥leur n√©cessite model.php, et utilise l'objet de la base de donn√©es, appelle la m√©thode s√©lectionn√©e pour r√©cup√©rer les donn√©es de la base de donn√©es. Le r√©sultat est stock√© dans la session en cours afin qu'il puisse √™tre consult√© sur la page de vue.

```php
<?php
   session_start();
   require "model.php";
   $results = $_DB->select(
      "SELECT * FROM `users` WHERE `name` LIKE ?",
      ["%{$_POST["search"]}%"]
   );
   $_SESSION['search'] = $_POST['search'];
   $_SESSION['result'] = $results;
   Header("Location: view.php", true);
?>
```

La couche mod√®le de l'application est cod√©e dans "model.php". Elle √©tablit la connexion avec la base de donn√©es mysql nomm√©e mydb, en utilisant l'extension PDO.

```php
<?php
   class DB {
      public $error = "";
      private $pdo = null;
      private $stmt = null;
      var $dsn="localhost";  
      var $dbName="myDB";  
      var $username="root";       
      var $password=""; 
      function __construct () {
         $this->pdo = new PDO("mysql:host=$this->dsn;dbname=$this->
            dbName",$this->username,$this->password); 
      }
      function __destruct () {
         if ($this->stmt!==null) { $this->stmt = null; }
         if ($this->pdo!==null) { $this->pdo = null; }
      }
      function select ($sql, $data=null) {
         $this->stmt = $this->pdo->prepare($sql);
         $this->stmt->execute($data); 
         return $this->stmt->fetchAll();
      }
   }
   $_DB = new DB();
?>
```

La base de donn√©es de backend mydb doit avoir une table d'utilisateurs avec les champs ID et NAME.

```sql
-- Table structure for table `users`
--
CREATE TABLE `users` (
   `id` bigint(20) NOT NULL,
   `name` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `users`
--
INSERT INTO `users` (`id`, `name`) VALUES
(21, 'Ahmad Shaikh'),
(24, 'Akshay Wadkar'),
(26, 'Bridget Wooten'),
(10, 'Coby Kelleigh'),
(20, 'Dashan Shah'),
(12, 'Elizabeth Taylor'),
(41, 'Issac Newton'),
(34, 'Julia Roberts'),
(31, 'Junior Mahmood'),
(32, 'Kailas Bende'),
(47, 'Karan Sharma'),
(16, 'Kenneth Sanders'),
(28, 'Kirstie Thomas'),
(33, 'Lawrence Murphy'),
(14, 'Leah Shan'),
(51, 'Marcus Best'),
(29, 'Maya Pande'),
(50, 'Nathaniel Khan'),
(6, 'Richard Breann'),
(54, 'Rowan Avalos'),
(3, 'Rusty Terry'),
(37, 'Sacha Gross'),
(27, 'Sally Castillo'),
(11, 'Sarah Sanders'),
(18, 'Seth Sonnel'),
(38, 'Shannon Peterson'),
(25, 'Shayan Clements'),
(49, 'Shoaib Vickers'),
(43, 'Simran Kaur'),
(35, 'Sulaiman Gilmour'),
(44, 'Taran Morin'),
(48, 'Taran Morin'),
(22, 'Thelma Kim'),
(8, 'Tillie Sharalyn'),
(36, 'Virgil Collier');
```

Commencez l'application en visitant "http://localhost/view.php" dans le navigateur. Saisissez un terme de recherche correspondant aux noms ayant requis des lettres.
