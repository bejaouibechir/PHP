# ğŸ“ TP1 â€” Composer : comprendre avant dâ€™utiliser

---

## ğŸ¯ Objectif du TP

DÃ©couvrir **Composer**, comprendre **pourquoi** il est indispensable dans l'Ã©cosystÃ¨me PHP moderne,  
et apprendre Ã  **l'installer, le tester et le manipuler** Ã  travers un mini-projet simple.

---

## ğŸ§­ Contexte

Avant Composer, le dÃ©veloppement PHP ressemblait Ã  un atelier sans boÃ®te Ã  outils partagÃ©e.  
Chaque dÃ©veloppeur :

- tÃ©lÃ©chargeait manuellement les bibliothÃ¨ques,

- gÃ©rait les versions Ã  la main,

- et devait inclure chaque fichier avec des `require` manuels.

ğŸ‘‰ RÃ©sultat : du code difficile Ã  maintenir, Ã  partager, et souvent cassÃ© dÃ¨s qu'on changeait de version.

---

## ğŸ’¡ Introduction Ã  Composer

**Composer** est le **gestionnaire de dÃ©pendances officiel de PHP**.  
Son rÃ´le est de **faire pour PHP ce que npm fait pour Node.js ou pip pour Python** :

| ProblÃ¨me d'avant                        | Solution avec Composer                            |
| --------------------------------------- | ------------------------------------------------- |
| Fichiers inclus manuellement            | Chargement automatique (autoload)                 |
| Versions incompatibles                  | Gestion centralisÃ©e des versions                  |
| DifficultÃ© Ã  partager un projet         | Fichier `composer.json` dÃ©crivant tout le projet  |
| Installation manuelle des bibliothÃ¨ques | TÃ©lÃ©chargement automatique via `composer install` |

**En rÃ©sumÃ© :** Composer permet Ã  PHP de travailler "en Ã©quipe" avec d'autres bibliothÃ¨ques sans friction.

---

## âš™ï¸ Ã‰tape 1 â€“ VÃ©rifier votre environnement PHP

Ouvrez un terminal et tapez :

```bash
php --version
```

âœ… Si vous voyez une version 8.x ou supÃ©rieure, tout va bien.  
Sinon, installez ou mettez Ã  jour PHP avant de continuer.

ğŸ’¬ **Pourquoi vÃ©rifier Ã§a ?**  
Parce que Composer s'appuie sur PHP.  
S'il ne trouve pas le moteur PHP ou une version trop ancienne, il ne fonctionnera pas.

---

## âš™ï¸ Ã‰tape 2 â€“ Installer Composer

### ğŸ”¹ Sur Windows

TÃ©lÃ©chargez le programme d'installation ici :  
ğŸ‘‰ [Composer](https://getcomposer.org/download/)

Puis exÃ©cutez :

```bash
composer --version
```

### ğŸ”¹ Alternative universelle (si la commande n'est pas reconnue)

Dans le terminal :

```bash
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php composer-setup.php
php composer.phar --version
```

ğŸ’¬ **Pourquoi installer Composer ainsi ?**  
Parce que cette mÃ©thode fonctionne mÃªme dans les environnements sans droits administratifs ou sur Linux.

---

## ğŸ§ª Ã‰tape 3 â€“ CrÃ©er votre premier projet Composer

1ï¸âƒ£ CrÃ©ez un dossier de travail :

```bash
mkdir tp1-composer
cd tp1-composer
```

2ï¸âƒ£ Initialisez un nouveau projet :

```bash
composer init --name=vendor/nom-projet --autoload=psr-4 -n
```

exemple concret:

```bash
composer init --name=bechir/myapp --autoload=psr-4 -n
```



Composer crÃ©e alors un fichier **composer.json**, vÃ©ritable carte d'identitÃ© de votre projet. Ainsi que les deux dossiers **vendor**  et **psr-4** 

![](C:\PHP\images\1\1.png)

ğŸ’¬ **Pourquoi le fichier composer.json est important ?**  
Parce qu'il dÃ©crit votre application, les bibliothÃ¨ques qu'elle utilise et la maniÃ¨re dont elles doivent Ãªtre chargÃ©es.

## **Vendor** (Ã‰diteur/DÃ©veloppeur)

- C'est votre **nom d'utilisateur** ou **nom de sociÃ©tÃ©**

- Exemples :
  
  - `symfony` (pour le framework Symfony)
  
  - `laravel` (pour Laravel)
  
  - `monentreprise` (votre sociÃ©tÃ©)
  
  - `monnom` (votre nom)

Format : `vendor/nom-du-package`

## **PSR-4** (Standard de chargement automatique)

- C'est une **norme PHP** pour charger les classes automatiquement

- **Sans PSR-4** : tu dois faire `require 'classes/MaClass.php';`

- **Avec PSR-4** : PHP trouve automatiquement tes classes

## Version complÃ¨te avec tous les paramÃ¨tres

```bash
composer init \
  --name=vendor/project \
  --description="Description du projet" \
  --author="Votre Nom <email@example.com>" \
  --type=project \
  --autoload=psr-4 \
  -n
```

## **Alternative : utiliser le mode interactif**

```bash
composer init
```

---

## âš™ï¸ Ã‰tape 4 â€“ Comprendre et tester l'autoload

Ajoutons une premiÃ¨re classe PHP Ã  charger automatiquement.

### CrÃ©er le dossier source :

```bash
mkdir src
```

### CrÃ©er le fichier **src/Bonjour.php** :

```php
<?php
namespace Vendor\NomProjet;  

class Bonjour {
    public static function dire(string $nom): string {
        return "Bonjour $nom ! Bienvenue dans le monde moderne de PHP ğŸ‰";
    }
}
```

### Ajouter l'autoload PSR-4 dans composer.json :

```json
{
    "name": "vendor/nom-projet",
    "autoload": {
        "psr-4": {
            "Vendor\\NomProjet\\": "src/"
        }
    },
    "verson": "1.0.0",
    "require": {}
}

```

ğŸ’¬ **Pourquoi PSR-4 ?**  
Parce que c'est le standard officiel pour que les frameworks et librairies PHP puissent Ãªtre interopÃ©rables.  
Chaque classe sait oÃ¹ elle se trouve grÃ¢ce Ã  son _namespace_.

---

## âš™ï¸ Ã‰tape 5 â€“ GÃ©nÃ©rer l'autoload

Dans le terminal :

```bash
composer dump-autoload
```

Cette commande gÃ©nÃ¨re le systÃ¨me d'autoloading automatique basÃ© sur la configuration PSR-4 dÃ©finie dans votre `composer.json`.

### ğŸ“ Comprendre le dossier `vendor/`

Le dossier `vendor/` est crÃ©Ã© par Composer et contient :

- **vendor/autoload.php** : Le fichier d'autoload principal que vous incluez dans votre application
- **vendor/composer/** : Les fichiers de configuration internes de l'autoloader
- **Toutes les dÃ©pendances externes** : Les bibliothÃ¨ques tierces que vous installez via Composer

ğŸ’¬ **Ã€ quoi sert le dossier vendor ?**

- Il centralise toutes les dÃ©pendances de votre projet
- Il contient le systÃ¨me d'autoloading automatique
- Il ne doit JAMAIS Ãªtre versionnÃ© dans Git (ajoutez-le dans `.gitignore`)
- Il peut Ãªtre rÃ©gÃ©nÃ©rÃ© Ã  tout moment avec `composer install`

### ğŸ”§ Comment manipuler le dossier vendor ?

- **Pour rÃ©gÃ©nÃ©rer** : `composer install` (lit `composer.json` et `composer.lock`)
- **Pour mettre Ã  jour** : `composer update` (met Ã  jour les versions selon `composer.json`)
- **Pour recrÃ©er l'autoload** : `composer dump-autoload` (utile quand vous ajoutez de nouvelles classes)

---

## ğŸ§© Ã‰tape 6 â€“ Tester dans un script

CrÃ©er le fichier **index.php** Ã  la racine du projet :

```php
<?php
require __DIR__ . '/vendor/autoload.php';

use Vendor\NomProjet\Bonjour;  

echo Bonjour::dire("Participant");
```

Lancer :

```bash
php index.php
```

âœ… **RÃ©sultat attendu :**

```
Bonjour Participant ! Bienvenue dans le monde moderne de PHP ğŸ‰
```

ğŸ’¬ **Ce que vous venez de faire :**

- Vous avez crÃ©Ã© un projet avec Composer,

- dÃ©clarÃ© un espace de noms (namespace),

- et chargÃ© automatiquement votre classe sans aucun `require`.

---

## ğŸ§  SynthÃ¨se pÃ©dagogique

| Ã‰tape                  | Ce qu'on a appris                         | Pourquoi c'est important           |
| ---------------------- | ----------------------------------------- | ---------------------------------- |
| VÃ©rifier PHP           | Assurer un environnement stable           | Composer dÃ©pend de PHP             |
| Installer Composer     | Comprendre la philosophie des dÃ©pendances | Base du dÃ©veloppement moderne      |
| CrÃ©er composer.json    | Structurer le projet                      | Description claire des dÃ©pendances |
| Ajouter autoload PSR-4 | Charger les classes intelligemment        | Fin des `require` manuels          |
| Tester une classe      | Relier thÃ©orie Ã  pratique                 | ComprÃ©hension immÃ©diate du gain    |

---

## ğŸš€ Extension facultative

### 1. CrÃ©ation de la classe Maths

CrÃ©ez le fichier **src/Maths.php** :

```php
<?php
namespace Vendor\NomProjet;  

class Maths {
    public static function addition(float $a, float $b): float {
        return $a + $b;
    }

    public static function soustraction(float $a, float $b): float {
        return $a - $b;
    }

    public static function multiplication(float $a, float $b): float {
        return $a * $b;
    }

    public static function division(float $a, float $b): float {
        if ($b == 0) {
            throw new \InvalidArgumentException("Division par zÃ©ro impossible");
        }
        return $a / $b;
    }
}
```

### 2. Mise Ã  jour du fichier index.php

Modifiez **index.php** pour tester la nouvelle classe :

```php
<?php
require __DIR__ . '/vendor/autoload.php';


use Vendor\NomProjet\Bonjour
use Vendor\NomProjet\Maths;

echo Bonjour::dire("Participant") . "\n\n";

// Test des opÃ©rations mathÃ©matiques
$x = 10;
$y = 4;

echo "=== Tests des opÃ©rations mathÃ©matiques ===\n";
echo "Addition : $x + $y = " . Maths::addition($x, $y) . "\n";
echo "Soustraction : $x - $y = " . Maths::soustraction($x, $y) . "\n";
echo "Multiplication : $x Ã— $y = " . Maths::multiplication($x, $y) . "\n";
echo "Division : $x Ã· $y = " . Maths::division($x, $y) . "\n";

// Test avec d'autres valeurs
echo "\n=== Tests supplÃ©mentaires ===\n";
echo "15 + 7 = " . Maths::addition(15, 7) . "\n";
echo "20 - 8 = " . Maths::soustraction(20, 8) . "\n";
```

### 3. VÃ©rification que l'autoload fonctionne sans require

**DÃ©monstration de l'autoload :**

Lancez le script :

```bash
php index.php
```

âœ… **RÃ©sultat attendu :**

```
Bonjour Participant ! Bienvenue dans le monde moderne de PHP ğŸ‰

=== Tests des opÃ©rations mathÃ©matiques ===
Addition : 10 + 4 = 14
Soustraction : 10 - 4 = 6
Multiplication : 10 Ã— 4 = 40
Division : 10 Ã· 4 = 2.5

=== Tests supplÃ©mentaires ===
15 + 7 = 22
20 - 8 = 12
```

**Observation importante :** Vous n'avez pas eu besoin d'ajouter de `require` pour la classe `Maths` ! L'autoload PSR-4 s'est chargÃ© de trouver et charger automatiquement la classe.

### 4. Test de rÃ©gÃ©nÃ©ration du dossier vendor

**Supprimez le dossier vendor :**

```bash
rm -rf vendor/
```

**VÃ©rifiez que le projet ne fonctionne plus :**

```bash
php index.php
```

âŒ Vous devriez voir une erreur comme :

```
Warning: require(vendor/autoload.php): Failed to open stream: No such file or directory in...
```

**RÃ©gÃ©nÃ©rez le dossier vendor :**

```bash
composer install
```

âœ… Composer va :

- Lire le fichier `composer.json`
- RecrÃ©er le dossier `vendor/`
- RÃ©gÃ©nÃ©rer l'autoloader
- CrÃ©er/actualiser le fichier `composer.lock`

**Retestez :**

```bash
php index.php
```

âœ… Le projet fonctionne Ã  nouveau parfaitement !

### 5. Alternative : utiliser dump-autoload

Si vous ajoutez seulement de nouvelles classes (sans nouvelles dÃ©pendances), vous pouvez utiliser :

```bash
composer dump-autoload
```

Cette commande est plus rapide car elle ne rÃ©installe pas les dÃ©pendances, mais met seulement Ã  jour l'autoloader.

---

## ğŸ“ RÃ©sultat attendu

Ã€ la fin de ce TP, chaque participant doit :

- savoir **ce qu'est Composer** et **Ã  quoi il sert**,

- comprendre **ce qu'il change dans la maniÃ¨re d'Ã©crire du PHP**,

- Ãªtre capable de **crÃ©er et tester un projet Composer fonctionnel**,

- et surtout **sentir la diffÃ©rence** entre le PHP "manuel" et le PHP "moderne".
